"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RichAction=void 0;const core_1=require("../../../core");class RichAction{constructor(action,pipeline){this.action=action,this.pipeline=pipeline,this.actionProperties=action.actionProperties}bind(scope,stage,options){return this.action.bind(scope,stage,options)}onStateChange(name,target,options){return this.action.onStateChange(name,target,options)}get isCrossRegion(){return!actionDimensionSameAsPipelineDimension(this.effectiveRegion,this.pipeline.env.region)}get isCrossAccount(){return!actionDimensionSameAsPipelineDimension(this.effectiveAccount,this.pipeline.env.account)}get resourceStack(){const actionResource=this.actionProperties.resource;if(!actionResource)return;const actionResourceStack=core_1.Stack.of(actionResource),actionResourceStackEnv={region:actionResourceStack.region,account:actionResourceStack.account};return sameEnv(actionResource.env,actionResourceStackEnv)?actionResourceStack:void 0}get effectiveRegion(){var _a,_b;return(_b=(_a=this.action.actionProperties.resource)===null||_a===void 0?void 0:_a.env.region)!==null&&_b!==void 0?_b:this.action.actionProperties.region}get effectiveAccount(){var _a,_b,_c,_d,_e;return(_e=(_b=(_a=this.action.actionProperties.role)===null||_a===void 0?void 0:_a.env.account)!==null&&_b!==void 0?_b:(_d=(_c=this.action.actionProperties)===null||_c===void 0?void 0:_c.resource)===null||_d===void 0?void 0:_d.env.account)!==null&&_e!==void 0?_e:this.action.actionProperties.account}}exports.RichAction=RichAction;function actionDimensionSameAsPipelineDimension(actionDim,pipelineDim){return!actionDim||core_1.Token.isUnresolved(actionDim)?!0:core_1.Token.compareStrings(actionDim,pipelineDim)===core_1.TokenComparison.SAME}function sameEnv(env1,env2){return sameEnvDimension(env1.region,env2.region)&&sameEnvDimension(env1.account,env2.account)}function sameEnvDimension(dim1,dim2){return[core_1.TokenComparison.SAME,core_1.TokenComparison.BOTH_UNRESOLVED].includes(core_1.Token.compareStrings(dim1,dim2))}
//# sourceMappingURL=rich-action.js.map
