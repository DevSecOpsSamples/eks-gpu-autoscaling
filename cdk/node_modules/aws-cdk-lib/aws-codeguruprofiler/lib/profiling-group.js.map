{
  "version": 3,
  "sources": ["profiling-group.ts"],
  "sourcesContent": ["import { Grant, IGrantable } from '../../aws-iam';\nimport { ArnFormat, IResource, Lazy, Names, Resource, Stack } from '../../core';\nimport { Construct } from 'constructs';\nimport { CfnProfilingGroup } from './codeguruprofiler.generated';\n\n/**\n * The compute platform of the profiling group.\n */\nexport enum ComputePlatform {\n  /**\n   * Use AWS_LAMBDA if your application runs on AWS Lambda.\n   */\n  AWS_LAMBDA = 'AWSLambda',\n\n  /**\n   * Use Default if your application runs on a compute platform that is not AWS Lambda,\n   * such an Amazon EC2 instance, an on-premises server, or a different platform.\n   */\n  DEFAULT = 'Default',\n}\n\n/**\n * IResource represents a Profiling Group.\n */\nexport interface IProfilingGroup extends IResource {\n\n  /**\n   * A name for the profiling group.\n   *\n   * @attribute\n   */\n  readonly profilingGroupName: string;\n\n  /**\n   * Grant access to publish profiling information to the Profiling Group to the given identity.\n   *\n   * This will grant the following permissions:\n   *\n   *  - codeguru-profiler:ConfigureAgent\n   *  - codeguru-profiler:PostAgentProfile\n   *\n   * @param grantee Principal to grant publish rights to\n   */\n  grantPublish(grantee: IGrantable): Grant;\n\n  /**\n   * Grant access to read profiling information from the Profiling Group to the given identity.\n   *\n   * This will grant the following permissions:\n   *\n   *  - codeguru-profiler:GetProfile\n   *  - codeguru-profiler:DescribeProfilingGroup\n   *\n   * @param grantee Principal to grant read rights to\n   */\n  grantRead(grantee: IGrantable): Grant;\n\n}\n\nabstract class ProfilingGroupBase extends Resource implements IProfilingGroup {\n\n  public abstract readonly profilingGroupName: string;\n\n  public abstract readonly profilingGroupArn: string;\n\n  /**\n   * Grant access to publish profiling information to the Profiling Group to the given identity.\n   *\n   * This will grant the following permissions:\n   *\n   *  - codeguru-profiler:ConfigureAgent\n   *  - codeguru-profiler:PostAgentProfile\n   *\n   * @param grantee Principal to grant publish rights to\n   */\n  public grantPublish(grantee: IGrantable) {\n    // https://docs.aws.amazon.com/codeguru/latest/profiler-ug/security-iam.html#security-iam-access-control\n    return Grant.addToPrincipal({\n      grantee,\n      actions: ['codeguru-profiler:ConfigureAgent', 'codeguru-profiler:PostAgentProfile'],\n      resourceArns: [this.profilingGroupArn],\n    });\n  }\n\n  /**\n   * Grant access to read profiling information from the Profiling Group to the given identity.\n   *\n   * This will grant the following permissions:\n   *\n   *  - codeguru-profiler:GetProfile\n   *  - codeguru-profiler:DescribeProfilingGroup\n   *\n   * @param grantee Principal to grant read rights to\n   */\n  public grantRead(grantee: IGrantable) {\n    // https://docs.aws.amazon.com/codeguru/latest/profiler-ug/security-iam.html#security-iam-access-control\n    return Grant.addToPrincipal({\n      grantee,\n      actions: ['codeguru-profiler:GetProfile', 'codeguru-profiler:DescribeProfilingGroup'],\n      resourceArns: [this.profilingGroupArn],\n    });\n  }\n\n}\n\n/**\n * Properties for creating a new Profiling Group.\n */\nexport interface ProfilingGroupProps {\n\n  /**\n   * A name for the profiling group.\n   * @default - automatically generated name.\n   */\n  readonly profilingGroupName?: string;\n\n  /**\n   * The compute platform of the profiling group.\n   *\n   * @default ComputePlatform.DEFAULT\n   */\n  readonly computePlatform?: ComputePlatform;\n\n}\n\n/**\n * A new Profiling Group.\n */\nexport class ProfilingGroup extends ProfilingGroupBase {\n\n  /**\n   * Import an existing Profiling Group provided a Profiling Group Name.\n   *\n   * @param scope The parent creating construct\n   * @param id The construct's name\n   * @param profilingGroupName Profiling Group Name\n   */\n  public static fromProfilingGroupName(scope: Construct, id: string, profilingGroupName: string): IProfilingGroup {\n    const stack = Stack.of(scope);\n\n    return this.fromProfilingGroupArn(scope, id, stack.formatArn({\n      service: 'codeguru-profiler',\n      resource: 'profilingGroup',\n      resourceName: profilingGroupName,\n    }));\n  }\n\n  /**\n   * Import an existing Profiling Group provided an ARN.\n   *\n   * @param scope The parent creating construct\n   * @param id The construct's name\n   * @param profilingGroupArn Profiling Group ARN\n   */\n  public static fromProfilingGroupArn(scope: Construct, id: string, profilingGroupArn: string): IProfilingGroup {\n    class Import extends ProfilingGroupBase {\n      public readonly profilingGroupName = Stack.of(scope).splitArn(profilingGroupArn, ArnFormat.SLASH_RESOURCE_NAME).resource;\n      public readonly profilingGroupArn = profilingGroupArn;\n    }\n\n    return new Import(scope, id);\n  }\n\n  /**\n   * The name of the Profiling Group.\n   *\n   * @attribute\n   */\n  public readonly profilingGroupName: string;\n\n  /**\n   * The ARN of the Profiling Group.\n   *\n   * @attribute\n   */\n  public readonly profilingGroupArn: string;\n\n  constructor(scope: Construct, id: string, props: ProfilingGroupProps = {}) {\n    super(scope, id, {\n      physicalName: props.profilingGroupName ?? Lazy.string({ produce: () => this.generateUniqueId() }),\n    });\n\n    const profilingGroup = new CfnProfilingGroup(this, 'ProfilingGroup', {\n      profilingGroupName: this.physicalName,\n      computePlatform: props.computePlatform,\n    });\n\n    this.profilingGroupName = this.getResourceNameAttribute(profilingGroup.ref);\n\n    this.profilingGroupArn = this.getResourceArnAttribute(profilingGroup.attrArn, {\n      service: 'codeguru-profiler',\n      resource: 'profilingGroup',\n      resourceName: this.physicalName,\n    });\n  }\n\n  private generateUniqueId(): string {\n    const name = Names.uniqueId(this);\n    if (name.length > 240) {\n      return name.substring(0, 120) + name.substring(name.length - 120);\n    }\n    return name;\n  }\n\n}\n"],
  "mappings": "6OAAA,UAAA,QAAA,eAAA,EACA,OAAA,QAAA,YAAA,EAEA,6BAAA,QAAA,8BAAA,EAKA,GAAY,iBAAZ,AAAA,UAAY,iBAAe,CAIzB,iBAAA,WAAA,YAMA,iBAAA,QAAA,SACF,GAXY,gBAAA,QAAA,iBAAA,SAAA,gBAAe,CAAA,EAAA,EAmD3B,MAAe,0BAA2B,QAAA,QAAQ,CAgBzC,aAAa,QAAmB,CAErC,MAAO,WAAA,MAAM,eAAe,CAC1B,QACA,QAAS,CAAC,mCAAoC,oCAAoC,EAClF,aAAc,CAAC,KAAK,iBAAiB,EACtC,EAaI,UAAU,QAAmB,CAElC,MAAO,WAAA,MAAM,eAAe,CAC1B,QACA,QAAS,CAAC,+BAAgC,0CAA0C,EACpF,aAAc,CAAC,KAAK,iBAAiB,EACtC,GA4BL,MAAa,sBAAuB,mBAAkB,CAiDpD,YAAY,MAAkB,GAAY,MAA6B,CAAA,EAAE,QACvE,MAAM,MAAO,GAAI,CACf,aAAY,IAAE,MAAM,sBAAkB,MAAA,KAAA,OAAA,GAAI,OAAA,KAAK,OAAO,CAAE,QAAS,IAAM,KAAK,iBAAgB,CAAE,CAAE,EACjG,sFAED,KAAM,gBAAiB,GAAI,8BAAA,kBAAkB,KAAM,iBAAkB,CACnE,mBAAoB,KAAK,aACzB,gBAAiB,MAAM,gBACxB,EAED,KAAK,mBAAqB,KAAK,yBAAyB,eAAe,GAAG,EAE1E,KAAK,kBAAoB,KAAK,wBAAwB,eAAe,QAAS,CAC5E,QAAS,oBACT,SAAU,iBACV,aAAc,KAAK,aACpB,QAxDW,wBAAuB,MAAkB,GAAY,mBAA0B,CAC3F,KAAM,OAAQ,OAAA,MAAM,GAAG,KAAK,EAE5B,MAAO,MAAK,sBAAsB,MAAO,GAAI,MAAM,UAAU,CAC3D,QAAS,oBACT,SAAU,iBACV,aAAc,mBACf,CAAC,QAUU,uBAAsB,MAAkB,GAAY,kBAAyB,CACzF,MAAM,cAAe,mBAAkB,CAAvC,aAAA,qBACkB,KAAA,mBAAqB,OAAA,MAAM,GAAG,KAAK,EAAE,SAAS,kBAAmB,OAAA,UAAU,mBAAmB,EAAE,SAChG,KAAA,kBAAoB,iBACtC,EAEA,MAAO,IAAI,QAAO,MAAO,EAAE,EAoCrB,kBAAgB,CACtB,KAAM,MAAO,OAAA,MAAM,SAAS,IAAI,EAChC,MAAI,MAAK,OAAS,IACT,KAAK,UAAU,EAAG,GAAG,EAAI,KAAK,UAAU,KAAK,OAAS,GAAG,EAE3D,MAzEX,QAAA,eAAA",
  "names": []
}
