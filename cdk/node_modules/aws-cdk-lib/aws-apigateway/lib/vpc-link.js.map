{
  "version": 3,
  "sources": ["vpc-link.ts"],
  "sourcesContent": ["import * as elbv2 from '../../aws-elasticloadbalancingv2';\nimport { IResource, Lazy, Names, Resource } from '../../core';\nimport { Construct } from 'constructs';\nimport { CfnVpcLink } from './apigateway.generated';\n\n/**\n * Represents an API Gateway VpcLink\n */\nexport interface IVpcLink extends IResource {\n  /**\n   * Physical ID of the VpcLink resource\n   * @attribute\n   */\n  readonly vpcLinkId: string;\n}\n\n/**\n * Properties for a VpcLink\n */\nexport interface VpcLinkProps {\n  /**\n   * The name used to label and identify the VPC link.\n   * @default - automatically generated name\n   */\n  readonly vpcLinkName?: string;\n\n  /**\n   * The description of the VPC link.\n   * @default no description\n   */\n  readonly description?: string;\n\n  /**\n   * The network load balancers of the VPC targeted by the VPC link.\n   * The network load balancers must be owned by the same AWS account of the API owner.\n   *\n   * @default - no targets. Use `addTargets` to add targets\n   */\n  readonly targets?: elbv2.INetworkLoadBalancer[];\n}\n\n/**\n * Define a new VPC Link\n * Specifies an API Gateway VPC link for a RestApi to access resources in an Amazon Virtual Private Cloud (VPC).\n */\nexport class VpcLink extends Resource implements IVpcLink {\n  /**\n   * Import a VPC Link by its Id\n   */\n  public static fromVpcLinkId(scope: Construct, id: string, vpcLinkId: string): IVpcLink {\n    class Import extends Resource implements IVpcLink {\n      public vpcLinkId = vpcLinkId;\n    }\n\n    return new Import(scope, id);\n  }\n\n  /**\n   * Physical ID of the VpcLink resource\n   * @attribute\n   */\n  public readonly vpcLinkId: string;\n\n  private readonly _targets = new Array<elbv2.INetworkLoadBalancer>();\n\n  constructor(scope: Construct, id: string, props: VpcLinkProps = {}) {\n    super(scope, id, {\n      physicalName: props.vpcLinkName ||\n        Lazy.string({ produce: () => Names.nodeUniqueId(this.node) }),\n    });\n\n    const cfnResource = new CfnVpcLink(this, 'Resource', {\n      name: this.physicalName,\n      description: props.description,\n      targetArns: Lazy.list({ produce: () => this.renderTargets() }),\n    });\n\n    this.vpcLinkId = cfnResource.ref;\n\n    if (props.targets) {\n      this.addTargets(...props.targets);\n    }\n\n    this.node.addValidation({ validate: () => this.validateVpcLink() });\n  }\n\n  public addTargets(...targets: elbv2.INetworkLoadBalancer[]) {\n    this._targets.push(...targets);\n  }\n\n  /**\n   * Return the list of DNS names from the target NLBs.\n   * @internal\n   * */\n  public get _targetDnsNames(): string[] {\n    return this._targets.map(t => t.loadBalancerDnsName);\n  }\n\n  private validateVpcLink(): string[] {\n    if (this._targets.length === 0) {\n      return ['No targets added to vpc link'];\n    }\n    return [];\n  }\n\n  private renderTargets() {\n    return this._targets.map(nlb => nlb.loadBalancerArn);\n  }\n}\n"],
  "mappings": "8MACA,OAAA,QAAA,YAAA,EAEA,uBAAA,QAAA,wBAAA,EA0CA,MAAa,eAAgB,QAAA,QAAQ,CAoBnC,YAAY,MAAkB,GAAY,MAAsB,CAAA,EAAE,CAChE,MAAM,MAAO,GAAI,CACf,aAAc,MAAM,aAClB,OAAA,KAAK,OAAO,CAAE,QAAS,IAAM,OAAA,MAAM,aAAa,KAAK,IAAI,CAAC,CAAE,EAC/D,EANc,KAAA,SAAW,GAAI,8EAQ9B,KAAM,aAAc,GAAI,wBAAA,WAAW,KAAM,WAAY,CACnD,KAAM,KAAK,aACX,YAAa,MAAM,YACnB,WAAY,OAAA,KAAK,KAAK,CAAE,QAAS,IAAM,KAAK,cAAa,CAAE,CAAE,EAC9D,EAED,KAAK,UAAY,YAAY,IAEzB,MAAM,SACR,KAAK,WAAW,GAAG,MAAM,OAAO,EAGlC,KAAK,KAAK,cAAc,CAAE,SAAU,IAAM,KAAK,gBAAe,CAAE,CAAE,QAlCtD,eAAc,MAAkB,GAAY,UAAiB,CACzE,MAAM,cAAe,QAAA,QAAQ,CAA7B,aAAA,qBACS,KAAA,UAAY,SACrB,EAEA,MAAO,IAAI,QAAO,MAAO,EAAE,EAgCtB,cAAc,QAAqC,8FACxD,KAAK,SAAS,KAAK,GAAG,OAAO,KAOpB,kBAAe,CACxB,MAAO,MAAK,SAAS,IAAI,GAAK,EAAE,mBAAmB,EAG7C,iBAAe,CACrB,MAAI,MAAK,SAAS,SAAW,EACpB,CAAC,8BAA8B,EAEjC,CAAA,EAGD,eAAa,CACnB,MAAO,MAAK,SAAS,IAAI,KAAO,IAAI,eAAe,GA7DvD,QAAA,QAAA",
  "names": []
}
