{
  "version": 3,
  "sources": ["unknown-principal.ts"],
  "sourcesContent": ["import { Annotations, Stack } from '../../core';\nimport { DependencyGroup, IConstruct, Node } from 'constructs';\nimport { PolicyStatement } from './policy-statement';\nimport { AddToPrincipalPolicyResult, IPrincipal, PrincipalPolicyFragment } from './principals';\n\n/**\n * Properties for an UnknownPrincipal\n */\nexport interface UnknownPrincipalProps {\n  /**\n   * The resource the role proxy is for\n   */\n  readonly resource: IConstruct;\n}\n\n/**\n * A principal for use in resources that need to have a role but it's unknown\n *\n * Some resources have roles associated with them which they assume, such as\n * Lambda Functions, CodeBuild projects, StepFunctions machines, etc.\n *\n * When those resources are imported, their actual roles are not always\n * imported with them. When that happens, we use an instance of this class\n * instead, which will add user warnings when statements are attempted to be\n * added to it.\n */\nexport class UnknownPrincipal implements IPrincipal {\n  public readonly assumeRoleAction: string = 'sts:AssumeRole';\n  public readonly grantPrincipal: IPrincipal;\n  private readonly resource: IConstruct;\n\n  constructor(props: UnknownPrincipalProps) {\n    this.resource = props.resource;\n    this.grantPrincipal = this;\n  }\n\n  public get policyFragment(): PrincipalPolicyFragment {\n    throw new Error(`Cannot get policy fragment of ${Node.of(this.resource).path}, resource imported without a role`);\n  }\n\n  public addToPrincipalPolicy(statement: PolicyStatement): AddToPrincipalPolicyResult {\n    const stack = Stack.of(this.resource);\n    const repr = JSON.stringify(stack.resolve(statement));\n    Annotations.of(this.resource).addWarning(`Add statement to this resource's role: ${repr}`);\n    // Pretend we did the work. The human will do it for us, eventually.\n    return { statementAdded: true, policyDependable: new DependencyGroup() };\n  }\n\n  public addToPolicy(statement: PolicyStatement): boolean {\n    return this.addToPrincipalPolicy(statement).statementAdded;\n  }\n}"],
  "mappings": "uNAAA,OAAA,QAAA,YAAA,EACA,aAAA,QAAA,YAAA,EAyBA,MAAa,gBAAgB,CAK3B,YAAY,MAA4B,CAJxB,KAAA,iBAA2B,0FAKzC,KAAK,SAAW,MAAM,SACtB,KAAK,eAAiB,QAGb,iBAAc,CACvB,KAAM,IAAI,OAAM,iCAAiC,aAAA,KAAK,GAAG,KAAK,QAAQ,EAAE,wCAAwC,EAG3G,qBAAqB,UAA0B,wEACpD,KAAM,OAAQ,OAAA,MAAM,GAAG,KAAK,QAAQ,EAC9B,KAAO,KAAK,UAAU,MAAM,QAAQ,SAAS,CAAC,EACpD,cAAA,YAAY,GAAG,KAAK,QAAQ,EAAE,WAAW,0CAA0C,MAAM,EAElF,CAAE,eAAgB,GAAM,iBAAkB,GAAI,cAAA,eAAiB,EAGjE,YAAY,UAA0B,+EACpC,KAAK,qBAAqB,SAAS,EAAE,gBAvBhD,QAAA,iBAAA",
  "names": []
}
