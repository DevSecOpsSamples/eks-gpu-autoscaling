"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handler=exports.invoke=void 0;const AWS=require("aws-sdk");exports.invoke=async functionName=>{const lambda=new AWS.Lambda,invokeRequest={FunctionName:functionName};console.log({invokeRequest});const invokeResponse=await lambda.invoke(invokeRequest).promise();return console.log({invokeResponse}),invokeResponse};async function handler(event){var _a;if(console.log({event}),event.RequestType==="Delete"){console.log("not calling trigger on DELETE");return}const handlerArn=event.ResourceProperties.HandlerArn;if(!handlerArn)throw new Error('The "HandlerArn" property is required');const invokeResponse=await exports.invoke(handlerArn);if(invokeResponse.StatusCode!==200)throw new Error(`Trigger handler failed with status code ${invokeResponse.StatusCode}`);if(invokeResponse.FunctionError)throw new Error(parseError((_a=invokeResponse.Payload)===null||_a===void 0?void 0:_a.toString()))}exports.handler=handler;function parseError(payload){if(console.log(`Error payload: ${payload}`),!payload)return"unknown handler error";try{const error=JSON.parse(payload),concat=[error.errorMessage,error.trace].filter(x=>x).join(`
`);return concat.length>0?concat:payload}catch{return payload}}
//# sourceMappingURL=index.js.map
