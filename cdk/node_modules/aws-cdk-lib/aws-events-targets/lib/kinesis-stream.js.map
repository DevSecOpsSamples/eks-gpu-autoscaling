{
  "version": 3,
  "sources": ["kinesis-stream.ts"],
  "sourcesContent": ["import * as events from '../../aws-events';\nimport * as iam from '../../aws-iam';\nimport * as kinesis from '../../aws-kinesis';\nimport { singletonEventRole } from './util';\n\n/**\n * Customize the Kinesis Stream Event Target\n */\nexport interface KinesisStreamProps {\n  /**\n   * Partition Key Path for records sent to this stream\n   *\n   * @default - eventId as the partition key\n   */\n  readonly partitionKeyPath?: string;\n\n  /**\n   * The message to send to the stream.\n   *\n   * Must be a valid JSON text passed to the target stream.\n   *\n   * @default - the entire CloudWatch event\n   */\n  readonly message?: events.RuleTargetInput;\n\n}\n\n/**\n * Use a Kinesis Stream as a target for AWS CloudWatch event rules.\n *\n * @example\n *   /// fixture=withRepoAndKinesisStream\n *   // put to a Kinesis stream every time code is committed\n *   // to a CodeCommit repository\n *   repository.onCommit('onCommit', { target: new targets.KinesisStream(stream) });\n *\n */\nexport class KinesisStream implements events.IRuleTarget {\n\n  constructor(private readonly stream: kinesis.IStream, private readonly props: KinesisStreamProps = {}) {\n  }\n\n  /**\n   * Returns a RuleTarget that can be used to trigger this Kinesis Stream as a\n   * result from a CloudWatch event.\n   */\n  public bind(_rule: events.IRule, _id?: string): events.RuleTargetConfig {\n    const policyStatements = [new iam.PolicyStatement({\n      actions: ['kinesis:PutRecord', 'kinesis:PutRecords'],\n      resources: [this.stream.streamArn],\n    })];\n\n    return {\n      arn: this.stream.streamArn,\n      role: singletonEventRole(this.stream, policyStatements),\n      input: this.props.message,\n      targetResource: this.stream,\n      kinesisParameters: this.props.partitionKeyPath ? { partitionKeyPath: this.props.partitionKeyPath } : undefined,\n    };\n  }\n\n}\n"],
  "mappings": "oNACA,IAAA,QAAA,eAAA,EAEA,OAAA,QAAA,QAAA,EAkCA,MAAa,aAAa,CAExB,YAA6B,OAA0C,MAA4B,CAAA,EAAE,CAAxE,KAAA,OAAA,OAA0C,KAAA,MAAA,uJAOhE,KAAK,MAAqB,IAAY,6DAC3C,KAAM,kBAAmB,CAAC,GAAI,KAAI,gBAAgB,CAChD,QAAS,CAAC,oBAAqB,oBAAoB,EACnD,UAAW,CAAC,KAAK,OAAO,SAAS,EAClC,CAAC,EAEF,MAAO,CACL,IAAK,KAAK,OAAO,UACjB,KAAM,OAAA,mBAAmB,KAAK,OAAQ,gBAAgB,EACtD,MAAO,KAAK,MAAM,QAClB,eAAgB,KAAK,OACrB,kBAAmB,KAAK,MAAM,iBAAmB,CAAE,iBAAkB,KAAK,MAAM,gBAAgB,EAAK,SApB3G,QAAA,cAAA",
  "names": []
}
