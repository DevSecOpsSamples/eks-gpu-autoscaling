{
  "version": 3,
  "sources": ["log-group-resource-policy.ts"],
  "sourcesContent": ["import * as iam from '../../aws-iam';\nimport * as cdk from '../../core';\nimport * as cr from '../../custom-resources';\nimport { Construct } from 'constructs';\n\n/**\n * Properties to configure a log group resource policy\n */\nexport interface LogGroupResourcePolicyProps {\n  /**\n   * The log group resource policy name\n   */\n  readonly policyName?: string;\n  /**\n   * The policy statements for the log group resource logs\n   */\n  readonly policyStatements: [iam.PolicyStatement];\n}\n\n/**\n * Creates LogGroup resource policies.\n */\nexport class LogGroupResourcePolicy extends cr.AwsCustomResource {\n  constructor(scope: Construct, id: string, props: LogGroupResourcePolicyProps) {\n    const policyDocument = new iam.PolicyDocument({\n      statements: props.policyStatements,\n    });\n\n    let policyName = props.policyName || cdk.Lazy.string({ produce: () => cdk.Names.uniqueId(this) });\n\n    super(scope, id, {\n      resourceType: 'Custom::CloudwatchLogResourcePolicy',\n      onUpdate: {\n        service: 'CloudWatchLogs',\n        action: 'putResourcePolicy',\n        parameters: {\n          policyName: policyName,\n          policyDocument: JSON.stringify(policyDocument),\n        },\n        physicalResourceId: cr.PhysicalResourceId.of(id),\n      },\n      onDelete: {\n        service: 'CloudWatchLogs',\n        action: 'deleteResourcePolicy',\n        parameters: {\n          policyName: policyName,\n        },\n        ignoreErrorCodesMatching: '400',\n      },\n      policy: cr.AwsCustomResourcePolicy.fromSdkCalls({\n        // putResourcePolicy and deleteResourcePolicy don't support resource-level permissions. We must specify all resources (\"*\").\n        // https://docs.aws.amazon.com/IAM/latest/UserGuide/list_amazoncloudwatchlogs.html\n        resources: cr.AwsCustomResourcePolicy.ANY_RESOURCE,\n      }),\n    });\n  }\n}\n"],
  "mappings": "0GAAA,KAAA,KAAA,QAAA,eAAA,EACA,IAAA,QAAA,YAAA,EACA,GAAA,QAAA,wBAAA,EAoBA,MAAa,8BAA+B,IAAG,iBAAiB,CAC9D,YAAY,MAAkB,GAAY,MAAkC,CAC1E,KAAM,gBAAiB,GAAI,KAAI,eAAe,CAC5C,WAAY,MAAM,iBACnB,EAED,GAAI,YAAa,MAAM,YAAc,IAAI,KAAK,OAAO,CAAE,QAAS,IAAM,IAAI,MAAM,SAAS,IAAI,CAAC,CAAE,EAEhG,MAAM,MAAO,GAAI,CACf,aAAc,sCACd,SAAU,CACR,QAAS,iBACT,OAAQ,oBACR,WAAY,CACV,WACA,eAAgB,KAAK,UAAU,cAAc,GAE/C,mBAAoB,GAAG,mBAAmB,GAAG,EAAE,GAEjD,SAAU,CACR,QAAS,iBACT,OAAQ,uBACR,WAAY,CACV,YAEF,yBAA0B,OAE5B,OAAQ,GAAG,wBAAwB,aAAa,CAG9C,UAAW,GAAG,wBAAwB,aACvC,EACF,GAhCL,QAAA,uBAAA",
  "names": []
}
