{
  "version": 3,
  "sources": ["integ.cloudtrail-supplied-bucket.lit.ts"],
  "sourcesContent": ["import * as iam from '../../aws-iam';\nimport * as lambda from '../../aws-lambda';\nimport * as s3 from '../../aws-s3';\nimport * as cdk from '../../core';\n\nimport * as cloudtrail from '../lib';\n\nconst app = new cdk.App();\nconst stack = new cdk.Stack(app, 'integ-cloudtrail');\n\nconst bucket = new s3.Bucket(stack, 'Bucket', {\n  removalPolicy: cdk.RemovalPolicy.DESTROY,\n  autoDeleteObjects: true,\n});\nconst lambdaFunction = new lambda.Function(stack, 'LambdaFunction', {\n  runtime: lambda.Runtime.NODEJS_14_X,\n  handler: 'hello.handler',\n  code: lambda.Code.fromInline('exports.handler = {}'),\n});\n\n// using exctecy the same code as inside the cloudtrail class to produce the supplied bucket and policy\nconst cloudTrailPrincipal = new iam.ServicePrincipal('cloudtrail.amazonaws.com');\n\nconst Trailbucket = new s3.Bucket(stack, 'S3', {\n  encryption: s3.BucketEncryption.UNENCRYPTED,\n  removalPolicy: cdk.RemovalPolicy.DESTROY,\n  autoDeleteObjects: true,\n});\n\nTrailbucket.addToResourcePolicy(new iam.PolicyStatement({\n  resources: [Trailbucket.bucketArn],\n  actions: ['s3:GetBucketAcl'],\n  principals: [cloudTrailPrincipal],\n}));\n\nTrailbucket.addToResourcePolicy(new iam.PolicyStatement({\n  resources: [Trailbucket.arnForObjects(`AWSLogs/${cdk.Stack.of(stack).account}/*`)],\n  actions: ['s3:PutObject'],\n  principals: [cloudTrailPrincipal],\n  conditions: {\n    StringEquals: { 's3:x-amz-acl': 'bucket-owner-full-control' },\n  },\n}));\n\nconst trail = new cloudtrail.Trail(stack, 'Trail', { bucket: Trailbucket });\n\ntrail.addLambdaEventSelector([lambdaFunction]);\ntrail.addS3EventSelector([{ bucket }]);\n\napp.synth();\n"],
  "mappings": "oEAAA,KAAA,KAAA,QAAA,eAAA,EACA,OAAA,QAAA,kBAAA,EACA,GAAA,QAAA,cAAA,EACA,IAAA,QAAA,YAAA,EAEA,WAAA,QAAA,QAAA,EAEM,IAAM,GAAI,KAAI,IACd,MAAQ,GAAI,KAAI,MAAM,IAAK,kBAAkB,EAE7C,OAAS,GAAI,IAAG,OAAO,MAAO,SAAU,CAC5C,cAAe,IAAI,cAAc,QACjC,kBAAmB,GACpB,EACK,eAAiB,GAAI,QAAO,SAAS,MAAO,iBAAkB,CAClE,QAAS,OAAO,QAAQ,YACxB,QAAS,gBACT,KAAM,OAAO,KAAK,WAAW,sBAAsB,EACpD,EAGK,oBAAsB,GAAI,KAAI,iBAAiB,0BAA0B,EAEzE,YAAc,GAAI,IAAG,OAAO,MAAO,KAAM,CAC7C,WAAY,GAAG,iBAAiB,YAChC,cAAe,IAAI,cAAc,QACjC,kBAAmB,GACpB,EAED,YAAY,oBAAoB,GAAI,KAAI,gBAAgB,CACtD,UAAW,CAAC,YAAY,SAAS,EACjC,QAAS,CAAC,iBAAiB,EAC3B,WAAY,CAAC,mBAAmB,EACjC,CAAC,EAEF,YAAY,oBAAoB,GAAI,KAAI,gBAAgB,CACtD,UAAW,CAAC,YAAY,cAAc,WAAW,IAAI,MAAM,GAAG,KAAK,EAAE,WAAW,CAAC,EACjF,QAAS,CAAC,cAAc,EACxB,WAAY,CAAC,mBAAmB,EAChC,WAAY,CACV,aAAc,CAAE,eAAgB,2BAA2B,GAE9D,CAAC,EAEF,KAAM,OAAQ,GAAI,YAAW,MAAM,MAAO,QAAS,CAAE,OAAQ,WAAW,CAAE,EAE1E,MAAM,uBAAuB,CAAC,cAAc,CAAC,EAC7C,MAAM,mBAAmB,CAAC,CAAE,MAAM,CAAE,CAAC,EAErC,IAAI,MAAK",
  "names": []
}
