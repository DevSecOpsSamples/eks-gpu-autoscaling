{
  "version": 3,
  "sources": ["verify-imports-shielded.ts"],
  "sourcesContent": ["/**\n * Check that the imports from 'aws-cdk-lib' we expect to work, work, and those we have shielded off don't work.\n */\nimport * as os from 'os';\nimport * as path from 'path';\nimport * as fs from 'fs-extra';\n\nasync function main() {\n  // First make a tempdir and symlink `aws-cdk-lib` into it so we can refer to it\n  // as if it was an installed module.\n  await withTemporaryDirectory(async (tmpDir) => {\n    await fs.mkdirp(path.join(tmpDir, 'node_modules'));\n    await fs.symlink(path.resolve(__dirname, '..'), path.join(tmpDir, 'node_modules', 'aws-cdk-lib'));\n\n    assertImportSucceeds('aws-cdk-lib');\n    assertImportFails('aws-cdk-lib/LICENSE', 'ERR_PACKAGE_PATH_NOT_EXPORTED');\n    assertImportFails('aws-cdk-lib/aws-s3/lib/bucket', 'ERR_PACKAGE_PATH_NOT_EXPORTED');\n    assertImportSucceeds('aws-cdk-lib/aws-s3');\n\n    function assertImportSucceeds(name: string) {\n      require.resolve(name, { paths: [tmpDir] });\n    }\n\n    function assertImportFails(name: string, code: string) {\n      try {\n        require.resolve(name, { paths: [tmpDir] });\n\n        // eslint-disable-next-line no-console\n        console.error(`Import of '${name}' should have produced an error, but didn't.`);\n        process.exitCode = 1;\n      } catch (e) {\n        if ((e as any).code !== code) {\n          // eslint-disable-next-line no-console\n          console.error(`Import of '${name}' should have produced error ${code}, but got ${(e as any).code}.`);\n          process.exitCode = 1;\n        }\n      }\n    }\n  });\n}\n\n\nexport async function withTemporaryDirectory<T>(callback: (dir: string) => Promise<T>): Promise<T> {\n  const tmpdir = await fs.mkdtemp(path.join(os.tmpdir(), path.basename(__filename)));\n  try {\n    return await callback(tmpdir);\n  } finally {\n    await fs.remove(tmpdir);\n  }\n}\n\n\nmain().catch((e) => {\n  // eslint-disable-next-line no-console\n  console.error(e);\n  process.exitCode = 1;\n});\n"],
  "mappings": "0GAGA,KAAA,IAAA,QAAA,IAAA,EACA,KAAA,QAAA,MAAA,EACA,GAAA,QAAA,UAAA,EAEA,qBAAmB,CAGjB,KAAM,wBAAuB,KAAO,SAAU,CAC5C,KAAM,IAAG,OAAO,KAAK,KAAK,OAAQ,cAAc,CAAC,EACjD,KAAM,IAAG,QAAQ,KAAK,QAAQ,UAAW,IAAI,EAAG,KAAK,KAAK,OAAQ,eAAgB,aAAa,CAAC,EAEhG,qBAAqB,aAAa,EAClC,kBAAkB,sBAAuB,+BAA+B,EACxE,kBAAkB,gCAAiC,+BAA+B,EAClF,qBAAqB,oBAAoB,EAEzC,8BAA8B,KAAY,CACxC,QAAQ,QAAQ,KAAM,CAAE,MAAO,CAAC,MAAM,CAAC,CAAE,CAC3C,CAEA,2BAA2B,KAAc,KAAY,CACnD,GAAI,CACF,QAAQ,QAAQ,KAAM,CAAE,MAAO,CAAC,MAAM,CAAC,CAAE,EAGzC,QAAQ,MAAM,cAAc,kDAAkD,EAC9E,QAAQ,SAAW,QACZ,EAAP,CACA,AAAK,EAAU,OAAS,MAEtB,SAAQ,MAAM,cAAc,oCAAoC,iBAAkB,EAAU,OAAO,EACnG,QAAQ,SAAW,GAGzB,CACF,CAAC,CACH,CAGO,sCAAyC,SAAqC,CACnF,KAAM,QAAS,KAAM,IAAG,QAAQ,KAAK,KAAK,GAAG,OAAM,EAAI,KAAK,SAAS,UAAU,CAAC,CAAC,EACjF,GAAI,CACF,MAAO,MAAM,UAAS,MAAM,UAE5B,KAAM,IAAG,OAAO,MAAM,EAE1B,CAPA,QAAA,uBAAA,uBAUA,KAAI,EAAG,MAAM,AAAC,GAAK,CAEjB,QAAQ,MAAM,CAAC,EACf,QAAQ,SAAW,CACrB,CAAC",
  "names": []
}
