{
  "version": 3,
  "sources": ["fluentd-log-driver.ts"],
  "sourcesContent": ["import { Duration } from '../../../core';\nimport { Construct } from 'constructs';\nimport { ContainerDefinition } from '../container-definition';\nimport { BaseLogDriverProps } from './base-log-driver';\nimport { LogDriver, LogDriverConfig } from './log-driver';\nimport { renderCommonLogDriverOptions, stringifyOptions } from './utils';\n\n/**\n * Specifies the fluentd log driver configuration options.\n *\n * [Source](https://docs.docker.com/config/containers/logging/fluentd/)\n */\nexport interface FluentdLogDriverProps extends BaseLogDriverProps {\n  /**\n   * By default, the logging driver connects to localhost:24224. Supply the\n   * address option to connect to a different address. tcp(default) and unix\n   * sockets are supported.\n   *\n   * @default - address not set.\n   */\n  readonly address?: string;\n\n  /**\n   * Docker connects to Fluentd in the background. Messages are buffered until\n   * the connection is established.\n   *\n   * @default - false\n   */\n  readonly asyncConnect?: boolean;\n\n  /**\n   * The amount of data to buffer before flushing to disk.\n   *\n   * @default - The amount of RAM available to the container.\n   */\n  readonly bufferLimit?: number;\n\n  /**\n   * How long to wait between retries.\n   *\n   * @default - 1 second\n   */\n  readonly retryWait?: Duration;\n\n  /**\n   * The maximum number of retries.\n   *\n   * @default - 4294967295 (2**32 - 1).\n   */\n  readonly maxRetries?: number;\n\n  /**\n   * Generates event logs in nanosecond resolution.\n   *\n   * @default - false\n   */\n  readonly subSecondPrecision?: boolean;\n}\n\n/**\n * A log driver that sends log information to journald Logs.\n */\nexport class FluentdLogDriver extends LogDriver {\n  /**\n   * Constructs a new instance of the FluentdLogDriver class.\n   *\n   * @param props the fluentd log driver configuration options.\n   */\n  constructor(private readonly props: FluentdLogDriverProps = {}) {\n    super();\n  }\n\n  /**\n   * Called when the log driver is configured on a container\n   */\n  public bind(_scope: Construct, _containerDefinition: ContainerDefinition): LogDriverConfig {\n    return {\n      logDriver: 'fluentd',\n      options: stringifyOptions({\n        'fluentd-address': this.props.address,\n        'fluentd-async-connect': this.props.asyncConnect,\n        'fluentd-buffer-limit': this.props.bufferLimit,\n        'fluentd-retry-wait': this.props.retryWait && this.props.retryWait.toSeconds(),\n        'fluentd-max-retries': this.props.maxRetries,\n        'fluentd-sub-second-precision': this.props.subSecondPrecision,\n        ...renderCommonLogDriverOptions(this.props),\n      }),\n    };\n  }\n}\n"],
  "mappings": "0NAIA,aAAA,QAAA,cAAA,EACA,QAAA,QAAA,SAAA,EAyDA,MAAa,wBAAyB,cAAA,SAAS,CAM7C,YAA6B,MAA+B,CAAA,EAAE,CAC5D,MAAK,EADsB,KAAA,MAAA,+EAOtB,KAAK,OAAmB,qBAAyC,8FAC/D,CACL,UAAW,UACX,QAAS,QAAA,iBAAiB,CACxB,kBAAmB,KAAK,MAAM,QAC9B,wBAAyB,KAAK,MAAM,aACpC,uBAAwB,KAAK,MAAM,YACnC,qBAAsB,KAAK,MAAM,WAAa,KAAK,MAAM,UAAU,UAAS,EAC5E,sBAAuB,KAAK,MAAM,WAClC,+BAAgC,KAAK,MAAM,sBACxC,QAAA,6BAA6B,KAAK,KAAK,EAC3C,IAxBP,QAAA,iBAAA",
  "names": []
}
