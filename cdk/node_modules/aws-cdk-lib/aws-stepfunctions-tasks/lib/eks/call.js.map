{
  "version": 3,
  "sources": ["call.ts"],
  "sourcesContent": ["import * as eks from '../../../aws-eks';\nimport * as iam from '../../../aws-iam';\nimport * as sfn from '../../../aws-stepfunctions';\nimport { Construct } from 'constructs';\nimport { integrationResourceArn, validatePatternSupported } from '../private/task-utils';\n\n/**\n * Properties for calling a EKS endpoint with EksCall\n */\nexport interface EksCallProps extends sfn.TaskStateBaseProps {\n\n  /**\n   * The EKS cluster\n   */\n  readonly cluster: eks.ICluster;\n\n  /**\n   * HTTP method (\"GET\", \"POST\", \"PUT\", ...) part of HTTP request\n   */\n  readonly httpMethod: HttpMethods;\n\n  /**\n   * HTTP path of the Kubernetes REST API operation\n   * For example: /api/v1/namespaces/default/pods\n   */\n  readonly httpPath: string;\n\n  /**\n   * Query Parameters part of HTTP request\n   * @default - no query parameters\n   */\n  readonly queryParameters?: { [key: string]: string[] };\n\n  /**\n   * Request body part of HTTP request\n   * @default - No request body\n   */\n  readonly requestBody?: sfn.TaskInput;\n}\n\n/**\n * Call a EKS endpoint as a Task\n *\n * @see https://docs.aws.amazon.com/step-functions/latest/dg/connect-eks.html\n */\nexport class EksCall extends sfn.TaskStateBase {\n\n  private static readonly SUPPORTED_INTEGRATION_PATTERNS: sfn.IntegrationPattern[] = [\n    sfn.IntegrationPattern.REQUEST_RESPONSE,\n  ];\n\n  /** No policies are required due to eks:call is an Http service integration and does not call and EKS API directly\n   * @see https://docs.aws.amazon.com/step-functions/latest/dg/connect-eks.html#connect-eks-permissions\n   */\n  protected readonly taskMetrics?: sfn.TaskMetricsConfig;\n  protected readonly taskPolicies?: iam.PolicyStatement[];\n\n  private readonly integrationPattern: sfn.IntegrationPattern;\n\n  private readonly clusterEndpoint: string;\n  private readonly clusterCertificateAuthorityData: string;\n\n  constructor(scope: Construct, id: string, private readonly props: EksCallProps) {\n    super(scope, id, props);\n    this.integrationPattern = props.integrationPattern ?? sfn.IntegrationPattern.REQUEST_RESPONSE;\n\n    validatePatternSupported(this.integrationPattern, EksCall.SUPPORTED_INTEGRATION_PATTERNS);\n\n    try {\n      this.clusterEndpoint = this.props.cluster.clusterEndpoint;\n    } catch (e) {\n      throw new Error('The \"clusterEndpoint\" property must be specified when using an imported Cluster.');\n    }\n\n    try {\n      this.clusterCertificateAuthorityData = this.props.cluster.clusterCertificateAuthorityData;\n    } catch (e) {\n      throw new Error('The \"clusterCertificateAuthorityData\" property must be specified when using an imported Cluster.');\n    }\n  }\n\n  /**\n   * Provides the EKS Call service integration task configuration\n   * @internal\n   */\n  protected _renderTask(): any {\n    return {\n      Resource: integrationResourceArn('eks', 'call', this.integrationPattern),\n      Parameters: sfn.FieldUtils.renderObject({\n        ClusterName: this.props.cluster.clusterName,\n        CertificateAuthority: this.clusterCertificateAuthorityData,\n        Endpoint: this.clusterEndpoint,\n        Method: this.props.httpMethod,\n        Path: this.props.httpPath,\n        QueryParameters: this.props.queryParameters,\n        RequestBody: this.props.requestBody?.value,\n      }),\n    };\n  }\n}\n\n/**\n * Method type of a EKS call\n */\nexport enum HttpMethods {\n  /**\n   * Retrieve data from a server at the specified resource\n   */\n  GET = 'GET',\n\n  /**\n   * Send data to the API endpoint to create or update a resource\n   */\n  POST = 'POST',\n\n  /**\n   * Send data to the API endpoint to update or create a resource\n   */\n  PUT = 'PUT',\n\n  /**\n   * Delete the resource at the specified endpoint\n   */\n  DELETE = 'DELETE',\n\n  /**\n   * Apply partial modifications to the resource\n   */\n  PATCH = 'PATCH',\n\n  /**\n   * Retrieve data from a server at the specified resource without the response body\n   */\n  HEAD = 'HEAD'\n}"],
  "mappings": "qOAEA,IAAA,QAAA,4BAAA,EAEA,aAAA,QAAA,uBAAA,EAyCA,MAAa,eAAgB,KAAI,aAAa,CAiB5C,YAAY,MAAkB,GAA6B,MAAmB,QAC5E,MAAM,MAAO,GAAI,KAAK,EADmC,KAAA,MAAA,sFAEzD,KAAK,mBAAkB,IAAG,MAAM,sBAAkB,MAAA,KAAA,OAAA,GAAI,IAAI,mBAAmB,iBAE7E,aAAA,yBAAyB,KAAK,mBAAoB,QAAQ,8BAA8B,EAExF,GAAI,CACF,KAAK,gBAAkB,KAAK,MAAM,QAAQ,qBAC1C,CACA,KAAM,IAAI,OAAM,kFAAkF,EAGpG,GAAI,CACF,KAAK,gCAAkC,KAAK,MAAM,QAAQ,qCAC1D,CACA,KAAM,IAAI,OAAM,kGAAkG,GAQ5G,aAAW,QACnB,MAAO,CACL,SAAU,aAAA,uBAAuB,MAAO,OAAQ,KAAK,kBAAkB,EACvE,WAAY,IAAI,WAAW,aAAa,CACtC,YAAa,KAAK,MAAM,QAAQ,YAChC,qBAAsB,KAAK,gCAC3B,SAAU,KAAK,gBACf,OAAQ,KAAK,MAAM,WACnB,KAAM,KAAK,MAAM,SACjB,gBAAiB,KAAK,MAAM,gBAC5B,YAAW,IAAE,KAAK,MAAM,eAAW,MAAA,KAAA,OAAA,OAAA,GAAE,MACtC,IAnDP,QAAA,QAAA,+GAE0B,QAAA,+BAA2D,CACjF,IAAI,mBAAmB,kBAwD3B,GAAY,aAAZ,AAAA,UAAY,aAAW,CAIrB,aAAA,IAAA,MAKA,aAAA,KAAA,OAKA,aAAA,IAAA,MAKA,aAAA,OAAA,SAKA,aAAA,MAAA,QAKA,aAAA,KAAA,MACF,GA9BY,YAAA,QAAA,aAAA,SAAA,YAAW,CAAA,EAAA",
  "names": []
}
