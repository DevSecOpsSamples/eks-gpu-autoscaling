{
  "version": 3,
  "sources": ["send-message.ts"],
  "sourcesContent": ["import * as iam from '../../../aws-iam';\nimport * as sqs from '../../../aws-sqs';\nimport * as sfn from '../../../aws-stepfunctions';\nimport * as cdk from '../../../core';\nimport { Construct } from 'constructs';\nimport { integrationResourceArn, validatePatternSupported } from '../private/task-utils';\n\n/**\n * Properties for sending a message to an SQS queue\n */\nexport interface SqsSendMessageProps extends sfn.TaskStateBaseProps {\n\n  /**\n   * The SQS queue that messages will be sent to\n   */\n  readonly queue: sqs.IQueue\n\n  /**\n   * The text message to send to the queue.\n   */\n  readonly messageBody: sfn.TaskInput;\n\n  /**\n   * The length of time, for which to delay a message.\n   * Messages that you send to the queue remain invisible to consumers for the duration\n   * of the delay period. The maximum allowed delay is 15 minutes.\n   *\n   * @default - delay set on the queue. If a delay is not set on the queue,\n   *   messages are sent immediately (0 seconds).\n   */\n  readonly delay?: cdk.Duration;\n\n  /**\n   * The token used for deduplication of sent messages.\n   * Any messages sent with the same deduplication ID are accepted successfully,\n   * but aren't delivered during the 5-minute deduplication interval.\n   *\n   * @default - None\n   */\n  readonly messageDeduplicationId?: string;\n\n  /**\n   * The tag that specifies that a message belongs to a specific message group.\n   *\n   * Messages that belong to the same message group are processed in a FIFO manner.\n   * Messages in different message groups might be processed out of order.\n   *\n   * @default - None\n   */\n  readonly messageGroupId?: string;\n}\n\n/**\n * A StepFunctions Task to send messages to SQS queue.\n *\n */\nexport class SqsSendMessage extends sfn.TaskStateBase {\n\n  private static readonly SUPPORTED_INTEGRATION_PATTERNS: sfn.IntegrationPattern[] = [\n    sfn.IntegrationPattern.REQUEST_RESPONSE,\n    sfn.IntegrationPattern.WAIT_FOR_TASK_TOKEN,\n  ];\n\n  protected readonly taskMetrics?: sfn.TaskMetricsConfig;\n  protected readonly taskPolicies?: iam.PolicyStatement[];\n\n  private readonly integrationPattern: sfn.IntegrationPattern;\n\n  constructor(scope: Construct, id: string, private readonly props: SqsSendMessageProps) {\n    super(scope, id, props);\n    this.integrationPattern = props.integrationPattern ?? sfn.IntegrationPattern.REQUEST_RESPONSE;\n\n    validatePatternSupported(this.integrationPattern, SqsSendMessage.SUPPORTED_INTEGRATION_PATTERNS);\n\n    if (props.integrationPattern === sfn.IntegrationPattern.WAIT_FOR_TASK_TOKEN) {\n      if (!sfn.FieldUtils.containsTaskToken(props.messageBody)) {\n        throw new Error('Task Token is required in `messageBody` Use JsonPath.taskToken to set the token.');\n      }\n    }\n\n    this.taskPolicies = [\n      new iam.PolicyStatement({\n        actions: ['sqs:SendMessage'],\n        resources: [this.props.queue.queueArn],\n      }),\n    ];\n  }\n\n  /**\n   * Provides the SQS SendMessage service integration task configuration\n   */\n  /**\n   * @internal\n   */\n  protected _renderTask(): any {\n    return {\n      Resource: integrationResourceArn('sqs', 'sendMessage', this.integrationPattern),\n      Parameters: sfn.FieldUtils.renderObject({\n        QueueUrl: this.props.queue.queueUrl,\n        MessageBody: this.props.messageBody.value,\n        DelaySeconds: this.props.delay?.toSeconds(),\n        MessageDeduplicationId: this.props.messageDeduplicationId,\n        MessageGroupId: this.props.messageGroupId,\n      }),\n    };\n  }\n}\n"],
  "mappings": "wNAAA,IAAA,QAAA,kBAAA,EAEA,IAAA,QAAA,4BAAA,EAGA,aAAA,QAAA,uBAAA,EAmDA,MAAa,sBAAuB,KAAI,aAAa,CAYnD,YAAY,MAAkB,GAA6B,MAA0B,QACnF,MAAM,MAAO,GAAI,KAAK,EAKtB,GANyD,KAAA,MAAA,6FAEzD,KAAK,mBAAkB,IAAG,MAAM,sBAAkB,MAAA,KAAA,OAAA,GAAI,IAAI,mBAAmB,iBAE7E,aAAA,yBAAyB,KAAK,mBAAoB,eAAe,8BAA8B,EAE3F,MAAM,qBAAuB,IAAI,mBAAmB,qBAClD,CAAC,IAAI,WAAW,kBAAkB,MAAM,WAAW,EACrD,KAAM,IAAI,OAAM,kFAAkF,EAItG,KAAK,aAAe,CAClB,GAAI,KAAI,gBAAgB,CACtB,QAAS,CAAC,iBAAiB,EAC3B,UAAW,CAAC,KAAK,MAAM,MAAM,QAAQ,EACtC,GAUK,aAAW,QACnB,MAAO,CACL,SAAU,aAAA,uBAAuB,MAAO,cAAe,KAAK,kBAAkB,EAC9E,WAAY,IAAI,WAAW,aAAa,CACtC,SAAU,KAAK,MAAM,MAAM,SAC3B,YAAa,KAAK,MAAM,YAAY,MACpC,aAAY,IAAE,KAAK,MAAM,SAAK,MAAA,KAAA,OAAA,OAAA,GAAE,UAAS,EACzC,uBAAwB,KAAK,MAAM,uBACnC,eAAgB,KAAK,MAAM,eAC5B,IA/CP,QAAA,eAAA,oIAE0B,eAAA,+BAA2D,CACjF,IAAI,mBAAmB,iBACvB,IAAI,mBAAmB",
  "names": []
}
