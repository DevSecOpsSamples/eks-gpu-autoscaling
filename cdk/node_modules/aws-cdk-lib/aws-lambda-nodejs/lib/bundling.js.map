{
  "version": 3,
  "sources": ["bundling.ts"],
  "sourcesContent": ["import * as os from 'os';\nimport * as path from 'path';\nimport { Architecture, AssetCode, Code, Runtime } from '../../aws-lambda';\nimport * as cdk from '../../core';\nimport { PackageInstallation } from './package-installation';\nimport { PackageManager } from './package-manager';\nimport { BundlingOptions, OutputFormat, SourceMapMode } from './types';\nimport { exec, extractDependencies, findUp, getTsconfigCompilerOptions } from './util';\n\nconst ESBUILD_MAJOR_VERSION = '0';\n\n/**\n * Bundling properties\n */\nexport interface BundlingProps extends BundlingOptions {\n  /**\n   * Path to lock file\n   */\n  readonly depsLockFilePath: string;\n\n  /**\n   * Entry file\n   */\n  readonly entry: string;\n\n  /**\n   * The runtime of the lambda function\n   */\n  readonly runtime: Runtime;\n\n  /**\n   * The system architecture of the lambda function\n   */\n  readonly architecture: Architecture;\n\n  /**\n   * Path to project root\n   */\n  readonly projectRoot: string;\n\n  /**\n   * Run compilation using `tsc` before bundling\n   */\n  readonly preCompilation?: boolean\n\n}\n\n/**\n * Bundling with esbuild\n */\nexport class Bundling implements cdk.BundlingOptions {\n  /**\n   * esbuild bundled Lambda asset code\n   */\n  public static bundle(options: BundlingProps): AssetCode {\n    return Code.fromAsset(options.projectRoot, {\n      assetHash: options.assetHash,\n      assetHashType: options.assetHash ? cdk.AssetHashType.CUSTOM : cdk.AssetHashType.OUTPUT,\n      bundling: new Bundling(options),\n    });\n  }\n\n  public static clearEsbuildInstallationCache(): void {\n    this.esbuildInstallation = undefined;\n  }\n\n  public static clearTscInstallationCache(): void {\n    this.tscInstallation = undefined;\n  }\n\n  private static esbuildInstallation?: PackageInstallation;\n  private static tscInstallation?: PackageInstallation;\n\n  // Core bundling options\n  public readonly image: cdk.DockerImage;\n  public readonly command: string[];\n  public readonly environment?: { [key: string]: string };\n  public readonly workingDirectory: string;\n  public readonly local?: cdk.ILocalBundling;\n\n  private readonly projectRoot: string;\n  private readonly relativeEntryPath: string;\n  private readonly relativeTsconfigPath?: string;\n  private readonly relativeDepsLockFilePath: string;\n  private readonly externals: string[];\n  private readonly packageManager: PackageManager;\n\n  constructor(private readonly props: BundlingProps) {\n    this.packageManager = PackageManager.fromLockFile(props.depsLockFilePath, props.logLevel);\n\n    Bundling.esbuildInstallation = Bundling.esbuildInstallation ?? PackageInstallation.detect('esbuild');\n    Bundling.tscInstallation = Bundling.tscInstallation ?? PackageInstallation.detect('typescript');\n\n    this.projectRoot = props.projectRoot;\n    this.relativeEntryPath = path.relative(this.projectRoot, path.resolve(props.entry));\n    this.relativeDepsLockFilePath = path.relative(this.projectRoot, path.resolve(props.depsLockFilePath));\n\n    if (this.relativeDepsLockFilePath.includes('..')) {\n      throw new Error(`Expected depsLockFilePath: ${props.depsLockFilePath} to be under projectRoot: ${this.projectRoot} (${this.relativeDepsLockFilePath})`);\n    }\n\n    if (props.tsconfig) {\n      this.relativeTsconfigPath = path.relative(this.projectRoot, path.resolve(props.tsconfig));\n    }\n\n    if (props.preCompilation && !/\\.tsx?$/.test(props.entry)) {\n      throw new Error('preCompilation can only be used with typescript files');\n    }\n\n    if (props.format === OutputFormat.ESM\n        && (props.runtime === Runtime.NODEJS_10_X || props.runtime === Runtime.NODEJS_12_X)) {\n      throw new Error(`ECMAScript module output format is not supported by the ${props.runtime.name} runtime`);\n    }\n\n    this.externals = [\n      ...props.externalModules ?? ['aws-sdk'], // Mark aws-sdk as external by default (available in the runtime)\n      ...props.nodeModules ?? [], // Mark the modules that we are going to install as externals also\n    ];\n\n    // Docker bundling\n    const shouldBuildImage = props.forceDockerBundling || !Bundling.esbuildInstallation;\n    this.image = shouldBuildImage ? props.dockerImage ?? cdk.DockerImage.fromBuild(path.join(__dirname, '../lib'),\n      {\n        buildArgs: {\n          ...props.buildArgs ?? {},\n          IMAGE: props.runtime.bundlingImage.image,\n          ESBUILD_VERSION: props.esbuildVersion ?? ESBUILD_MAJOR_VERSION,\n        },\n        platform: props.architecture.dockerPlatform,\n      })\n      : cdk.DockerImage.fromRegistry('dummy'); // Do not build if we don't need to\n\n    const bundlingCommand = this.createBundlingCommand({\n      inputDir: cdk.AssetStaging.BUNDLING_INPUT_DIR,\n      outputDir: cdk.AssetStaging.BUNDLING_OUTPUT_DIR,\n      esbuildRunner: 'esbuild', // esbuild is installed globally in the docker image\n      tscRunner: 'tsc', // tsc is installed globally in the docker image\n      osPlatform: 'linux', // linux docker image\n    });\n    this.command = ['bash', '-c', bundlingCommand];\n    this.environment = props.environment;\n    // Bundling sets the working directory to cdk.AssetStaging.BUNDLING_INPUT_DIR\n    // and we want to force npx to use the globally installed esbuild.\n    this.workingDirectory = '/';\n\n    // Local bundling\n    if (!props.forceDockerBundling) { // only if Docker is not forced\n      this.local = this.getLocalBundlingProvider();\n    }\n  }\n\n  private createBundlingCommand(options: BundlingCommandOptions): string {\n    const pathJoin = osPathJoin(options.osPlatform);\n    let relativeEntryPath = pathJoin(options.inputDir, this.relativeEntryPath);\n    let tscCommand = '';\n\n    if (this.props.preCompilation) {\n      const tsconfig = this.props.tsconfig ?? findUp('tsconfig.json', path.dirname(this.props.entry));\n      if (!tsconfig) {\n        throw new Error('Cannot find a `tsconfig.json` but `preCompilation` is set to `true`, please specify it via `tsconfig`');\n      }\n      const compilerOptions = getTsconfigCompilerOptions(tsconfig);\n      tscCommand = `${options.tscRunner} \"${relativeEntryPath}\" ${compilerOptions}`;\n      relativeEntryPath = relativeEntryPath.replace(/\\.ts(x?)$/, '.js$1');\n    }\n\n    const loaders = Object.entries(this.props.loader ?? {});\n    const defines = Object.entries(this.props.define ?? {});\n\n    if (this.props.sourceMap === false && this.props.sourceMapMode) {\n      throw new Error('sourceMapMode cannot be used when sourceMap is false');\n    }\n\n    const sourceMapEnabled = this.props.sourceMapMode ?? this.props.sourceMap;\n    const sourceMapMode = this.props.sourceMapMode ?? SourceMapMode.DEFAULT;\n    const sourceMapValue = sourceMapMode === SourceMapMode.DEFAULT ? '' : `=${this.props.sourceMapMode}`;\n    const sourcesContent = this.props.sourcesContent ?? true;\n\n    const outFile = this.props.format === OutputFormat.ESM ? 'index.mjs' : 'index.js';\n    const esbuildCommand: string[] = [\n      options.esbuildRunner,\n      '--bundle', `\"${relativeEntryPath}\"`,\n      `--target=${this.props.target ?? toTarget(this.props.runtime)}`,\n      '--platform=node',\n      ...this.props.format ? [`--format=${this.props.format}`] : [],\n      `--outfile=\"${pathJoin(options.outputDir, outFile)}\"`,\n      ...this.props.minify ? ['--minify'] : [],\n      ...sourceMapEnabled ? [`--sourcemap${sourceMapValue}`] : [],\n      ...sourcesContent ? [] : [`--sources-content=${sourcesContent}`],\n      ...this.externals.map(external => `--external:${external}`),\n      ...loaders.map(([ext, name]) => `--loader:${ext}=${name}`),\n      ...defines.map(([key, value]) => `--define:${key}=${JSON.stringify(value)}`),\n      ...this.props.logLevel ? [`--log-level=${this.props.logLevel}`] : [],\n      ...this.props.keepNames ? ['--keep-names'] : [],\n      ...this.relativeTsconfigPath ? [`--tsconfig=${pathJoin(options.inputDir, this.relativeTsconfigPath)}`] : [],\n      ...this.props.metafile ? [`--metafile=${pathJoin(options.outputDir, 'index.meta.json')}`] : [],\n      ...this.props.banner ? [`--banner:js=${JSON.stringify(this.props.banner)}`] : [],\n      ...this.props.footer ? [`--footer:js=${JSON.stringify(this.props.footer)}`] : [],\n      ...this.props.charset ? [`--charset=${this.props.charset}`] : [],\n      ...this.props.mainFields ? [`--main-fields=${this.props.mainFields.join(',')}`] : [],\n      ...this.props.inject ? this.props.inject.map(i => `--inject:${i}`) : [],\n      ...this.props.esbuildArgs ? [toCliArgs(this.props.esbuildArgs)] : [],\n    ];\n\n    let depsCommand = '';\n    if (this.props.nodeModules) {\n      // Find 'package.json' closest to entry folder, we are going to extract the\n      // modules versions from it.\n      const pkgPath = findUp('package.json', path.dirname(this.props.entry));\n      if (!pkgPath) {\n        throw new Error('Cannot find a `package.json` in this project. Using `nodeModules` requires a `package.json`.');\n      }\n\n      // Determine dependencies versions, lock file and installer\n      const dependencies = extractDependencies(pkgPath, this.props.nodeModules);\n      const osCommand = new OsCommand(options.osPlatform);\n\n      const lockFilePath = pathJoin(options.inputDir, this.relativeDepsLockFilePath ?? this.packageManager.lockFile);\n\n      // Create dummy package.json, copy lock file if any and then install\n      depsCommand = chain([\n        osCommand.writeJson(pathJoin(options.outputDir, 'package.json'), { dependencies }),\n        osCommand.copy(lockFilePath, pathJoin(options.outputDir, this.packageManager.lockFile)),\n        osCommand.changeDirectory(options.outputDir),\n        this.packageManager.installCommand.join(' '),\n      ]);\n    }\n\n    return chain([\n      ...this.props.commandHooks?.beforeBundling(options.inputDir, options.outputDir) ?? [],\n      tscCommand,\n      esbuildCommand.join(' '),\n      ...(this.props.nodeModules && this.props.commandHooks?.beforeInstall(options.inputDir, options.outputDir)) ?? [],\n      depsCommand,\n      ...this.props.commandHooks?.afterBundling(options.inputDir, options.outputDir) ?? [],\n    ]);\n  }\n\n  private getLocalBundlingProvider(): cdk.ILocalBundling {\n    const osPlatform = os.platform();\n    const createLocalCommand = (outputDir: string, esbuild: PackageInstallation, tsc?: PackageInstallation) => this.createBundlingCommand({\n      inputDir: this.projectRoot,\n      outputDir,\n      esbuildRunner: esbuild.isLocal ? this.packageManager.runBinCommand('esbuild') : 'esbuild',\n      tscRunner: tsc && (tsc.isLocal ? this.packageManager.runBinCommand('tsc') : 'tsc'),\n      osPlatform,\n    });\n    const environment = this.props.environment ?? {};\n    const cwd = this.projectRoot;\n\n    return {\n      tryBundle(outputDir: string) {\n        if (!Bundling.esbuildInstallation) {\n          process.stderr.write('esbuild cannot run locally. Switching to Docker bundling.\\n');\n          return false;\n        }\n\n        if (!Bundling.esbuildInstallation.version.startsWith(`${ESBUILD_MAJOR_VERSION}.`)) {\n          throw new Error(`Expected esbuild version ${ESBUILD_MAJOR_VERSION}.x but got ${Bundling.esbuildInstallation.version}`);\n        }\n\n        const localCommand = createLocalCommand(outputDir, Bundling.esbuildInstallation, Bundling.tscInstallation);\n\n        exec(\n          osPlatform === 'win32' ? 'cmd' : 'bash',\n          [\n            osPlatform === 'win32' ? '/c' : '-c',\n            localCommand,\n          ],\n          {\n            env: { ...process.env, ...environment },\n            stdio: [ // show output\n              'ignore', // ignore stdio\n              process.stderr, // redirect stdout to stderr\n              'inherit', // inherit stderr\n            ],\n            cwd,\n            windowsVerbatimArguments: osPlatform === 'win32',\n          });\n\n        return true;\n      },\n    };\n  }\n}\n\ninterface BundlingCommandOptions {\n  readonly inputDir: string;\n  readonly outputDir: string;\n  readonly esbuildRunner: string;\n  readonly tscRunner?: string;\n  readonly osPlatform: NodeJS.Platform;\n}\n\n/**\n * OS agnostic command\n */\nclass OsCommand {\n  constructor(private readonly osPlatform: NodeJS.Platform) {}\n\n  public writeJson(filePath: string, data: any): string {\n    const stringifiedData = JSON.stringify(data);\n    if (this.osPlatform === 'win32') {\n      return `echo ^${stringifiedData}^ > \"${filePath}\"`;\n    }\n\n    return `echo '${stringifiedData}' > \"${filePath}\"`;\n  }\n\n  public copy(src: string, dest: string): string {\n    if (this.osPlatform === 'win32') {\n      return `copy \"${src}\" \"${dest}\"`;\n    }\n\n    return `cp \"${src}\" \"${dest}\"`;\n  }\n\n  public changeDirectory(dir: string): string {\n    return `cd \"${dir}\"`;\n  }\n}\n\n/**\n * Chain commands\n */\nfunction chain(commands: string[]): string {\n  return commands.filter(c => !!c).join(' && ');\n}\n\n/**\n * Platform specific path join\n */\nfunction osPathJoin(platform: NodeJS.Platform) {\n  return function(...paths: string[]): string {\n    const joined = path.join(...paths);\n    // If we are on win32 but need posix style paths\n    if (os.platform() === 'win32' && platform !== 'win32') {\n      return joined.replace(/\\\\/g, '/');\n    }\n    return joined;\n  };\n}\n\n/**\n * Converts a runtime to an esbuild node target\n */\nfunction toTarget(runtime: Runtime): string {\n  const match = runtime.name.match(/nodejs(\\d+)/);\n\n  if (!match) {\n    throw new Error('Cannot extract version from runtime.');\n  }\n\n  return `node${match[1]}`;\n}\n\nfunction toCliArgs(esbuildArgs: { [key: string]: string | boolean }): string {\n  const args = [];\n\n  for (const [key, value] of Object.entries(esbuildArgs)) {\n    if (value === true || value === '') {\n      args.push(key);\n    } else if (value) {\n      args.push(`${key}=\"${value}\"`);\n    }\n  }\n\n  return args.join(' ');\n}\n"],
  "mappings": "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",
  "names": []
}
