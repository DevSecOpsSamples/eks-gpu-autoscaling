"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.CfnMapping=void 0;const jsiiDeprecationWarnings=require("../../.warnings.jsii.js"),JSII_RTTI_SYMBOL_1=Symbol.for("jsii.rtti"),annotations_1=require("./annotations"),cfn_element_1=require("./cfn-element"),cfn_fn_1=require("./cfn-fn"),token_1=require("./token");class CfnMapping extends cfn_element_1.CfnRefElement{constructor(scope,id,props={}){super(scope,id);this.lazyRender=!1,this.lazyInformed=!1,jsiiDeprecationWarnings.aws_cdk_lib_CfnMappingProps(props),this.mapping=props.mapping?this.validateMapping(props.mapping):{},this.lazy=props.lazy}setValue(key1,key2,value){this.validateAlphanumeric(key2),key1 in this.mapping||(this.mapping[key1]={}),this.mapping[key1][key2]=value}findInMap(key1,key2){let fullyResolved=!1;if(!token_1.Token.isUnresolved(key1)){if(!(key1 in this.mapping))throw new Error(`Mapping doesn't contain top-level key '${key1}'`);if(!token_1.Token.isUnresolved(key2)){if(!(key2 in this.mapping[key1]))throw new Error(`Mapping doesn't contain second-level key '${key2}'`);fullyResolved=!0}}if(fullyResolved){if(this.lazy)return this.mapping[key1][key2]}else this.lazyRender=!0;return cfn_fn_1.Fn.findInMap(this.logicalId,key1,key2)}_toCloudFormation(){return this.lazy===void 0&&!this.lazyRender&&this.informLazyUse(),!this.lazy||this.lazy&&this.lazyRender?{Mappings:{[this.logicalId]:this.mapping}}:{}}informLazyUse(){this.lazyInformed||annotations_1.Annotations.of(this).addInfo("Consider making this CfnMapping a lazy mapping by providing `lazy: true`: either no findInMap was called or every findInMap could be immediately resolved without using Fn::FindInMap"),this.lazyInformed=!0}validateMapping(mapping){return Object.keys(mapping).forEach(m=>Object.keys(mapping[m]).forEach(this.validateAlphanumeric)),mapping}validateAlphanumeric(value){if(value.match(/[^a-zA-Z0-9]/g))throw new Error(`Attribute name '${value}' must contain only alphanumeric characters.`)}}exports.CfnMapping=CfnMapping,_a=JSII_RTTI_SYMBOL_1,CfnMapping[_a]={fqn:"aws-cdk-lib.CfnMapping",version:"2.20.0"};
//# sourceMappingURL=cfn-mapping.js.map
