{
  "version": 3,
  "sources": ["copy.ts"],
  "sourcesContent": ["import * as fs from 'fs';\nimport * as path from 'path';\nimport { IgnoreStrategy } from './ignore';\nimport { CopyOptions, SymlinkFollowMode } from './options';\nimport { shouldFollow } from './utils';\n\nexport function copyDirectory(srcDir: string, destDir: string, options: CopyOptions = { }, rootDir?: string) {\n  const follow = options.follow ?? SymlinkFollowMode.EXTERNAL;\n\n  rootDir = rootDir || srcDir;\n\n  const ignoreStrategy = IgnoreStrategy.fromCopyOptions(options, rootDir);\n\n  if (!fs.statSync(srcDir).isDirectory()) {\n    throw new Error(`${srcDir} is not a directory`);\n  }\n\n  const files = fs.readdirSync(srcDir);\n  for (const file of files) {\n    const sourceFilePath = path.join(srcDir, file);\n\n    if (ignoreStrategy.ignores(sourceFilePath)) {\n      continue;\n    }\n\n    const destFilePath = path.join(destDir, file);\n\n    let stat: fs.Stats | undefined = follow === SymlinkFollowMode.ALWAYS\n      ? fs.statSync(sourceFilePath)\n      : fs.lstatSync(sourceFilePath);\n\n    if (stat && stat.isSymbolicLink()) {\n      const target = fs.readlinkSync(sourceFilePath);\n\n      // determine if this is an external link (i.e. the target's absolute path\n      // is outside of the root directory).\n      const targetPath = path.normalize(path.resolve(srcDir, target));\n\n      if (shouldFollow(follow, rootDir, targetPath)) {\n        stat = fs.statSync(sourceFilePath);\n      } else {\n        fs.symlinkSync(target, destFilePath);\n        stat = undefined;\n      }\n    }\n\n    if (stat && stat.isDirectory()) {\n      fs.mkdirSync(destFilePath);\n      copyDirectory(sourceFilePath, destFilePath, options, rootDir);\n      stat = undefined;\n    }\n\n    if (stat && stat.isFile()) {\n      fs.copyFileSync(sourceFilePath, destFilePath);\n      stat = undefined;\n    }\n  }\n}\n"],
  "mappings": "iGAAA,KAAA,IAAA,QAAA,IAAA,EACA,KAAA,QAAA,MAAA,EACA,SAAA,QAAA,UAAA,EACA,UAAA,QAAA,WAAA,EACA,QAAA,QAAA,SAAA,EAEA,uBAA8B,OAAgB,QAAiB,QAAuB,CAAA,EAAK,QAAgB,QACzG,KAAM,QAAM,IAAG,QAAQ,UAAM,MAAA,KAAA,OAAA,GAAI,UAAA,kBAAkB,SAEnD,QAAU,SAAW,OAErB,KAAM,gBAAiB,SAAA,eAAe,gBAAgB,QAAS,OAAO,EAEtE,GAAI,CAAC,GAAG,SAAS,MAAM,EAAE,YAAW,EAClC,KAAM,IAAI,OAAM,GAAG,2BAA2B,EAGhD,KAAM,OAAQ,GAAG,YAAY,MAAM,EACnC,SAAW,QAAQ,OAAO,CACxB,KAAM,gBAAiB,KAAK,KAAK,OAAQ,IAAI,EAE7C,GAAI,eAAe,QAAQ,cAAc,EACvC,SAGF,KAAM,cAAe,KAAK,KAAK,QAAS,IAAI,EAE5C,GAAI,MAA6B,SAAW,UAAA,kBAAkB,OAC1D,GAAG,SAAS,cAAc,EAC1B,GAAG,UAAU,cAAc,EAE/B,GAAI,MAAQ,KAAK,eAAc,EAAI,CACjC,KAAM,QAAS,GAAG,aAAa,cAAc,EAIvC,WAAa,KAAK,UAAU,KAAK,QAAQ,OAAQ,MAAM,CAAC,EAE9D,AAAI,QAAA,aAAa,OAAQ,QAAS,UAAU,EAC1C,KAAO,GAAG,SAAS,cAAc,EAEjC,IAAG,YAAY,OAAQ,YAAY,EACnC,KAAO,QAIX,AAAI,MAAQ,KAAK,YAAW,GAC1B,IAAG,UAAU,YAAY,EACzB,cAAc,eAAgB,aAAc,QAAS,OAAO,EAC5D,KAAO,QAGL,MAAQ,KAAK,OAAM,GACrB,IAAG,aAAa,eAAgB,YAAY,EAC5C,KAAO,QAGb,CAnDA,QAAA,cAAA",
  "names": []
}
