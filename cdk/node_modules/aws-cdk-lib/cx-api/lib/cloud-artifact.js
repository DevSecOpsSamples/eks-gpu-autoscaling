"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:!0}),exports.CloudArtifact=void 0;const jsiiDeprecationWarnings=require("../../.warnings.jsii.js"),JSII_RTTI_SYMBOL_1=Symbol.for("jsii.rtti"),cxschema=require("../../cloud-assembly-schema"),metadata_1=require("./metadata");class CloudArtifact{constructor(assembly,id,manifest){this.assembly=assembly,this.id=id,jsiiDeprecationWarnings.aws_cdk_lib_cx_api_CloudAssembly(assembly),jsiiDeprecationWarnings.aws_cdk_lib_cloud_assembly_schema_ArtifactManifest(manifest),this.manifest=manifest,this.messages=this.renderMessages(),this._dependencyIDs=manifest.dependencies||[]}static fromManifest(assembly,id,artifact){throw jsiiDeprecationWarnings.aws_cdk_lib_cx_api_CloudAssembly(assembly),jsiiDeprecationWarnings.aws_cdk_lib_cloud_assembly_schema_ArtifactManifest(artifact),new Error("Implementation not overridden yet")}get dependencies(){return this._deps?this._deps:(this._deps=this._dependencyIDs.map(id=>{const dep=this.assembly.tryGetArtifact(id);if(!dep)throw new Error(`Artifact ${this.id} depends on non-existing artifact ${id}`);return dep}),this._deps)}findMetadataByType(type){const result=new Array;for(const path of Object.keys(this.manifest.metadata||{}))for(const entry of(this.manifest.metadata||{})[path])entry.type===type&&result.push({path,...entry});return result}renderMessages(){const messages=new Array;for(const[id,metadata]of Object.entries(this.manifest.metadata||{}))for(const entry of metadata){let level;switch(entry.type){case cxschema.ArtifactMetadataEntryType.WARN:level=metadata_1.SynthesisMessageLevel.WARNING;break;case cxschema.ArtifactMetadataEntryType.ERROR:level=metadata_1.SynthesisMessageLevel.ERROR;break;case cxschema.ArtifactMetadataEntryType.INFO:level=metadata_1.SynthesisMessageLevel.INFO;break;default:continue}messages.push({level,entry,id})}return messages}get hierarchicalId(){var _b;return(_b=this.manifest.displayName)!==null&&_b!==void 0?_b:this.id}}exports.CloudArtifact=CloudArtifact,_a=JSII_RTTI_SYMBOL_1,CloudArtifact[_a]={fqn:"aws-cdk-lib.cx_api.CloudArtifact",version:"2.20.0"};
//# sourceMappingURL=cloud-artifact.js.map
