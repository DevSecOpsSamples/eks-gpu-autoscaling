{
  "version": 3,
  "sources": ["topic.ts"],
  "sourcesContent": ["import { IKey } from '../../aws-kms';\nimport { ArnFormat, Stack } from '../../core';\nimport { Construct } from 'constructs';\nimport { CfnTopic } from './sns.generated';\nimport { ITopic, TopicBase } from './topic-base';\n\n/**\n * Properties for a new SNS topic\n */\nexport interface TopicProps {\n  /**\n   * A developer-defined string that can be used to identify this SNS topic.\n   *\n   * @default None\n   */\n  readonly displayName?: string;\n\n  /**\n   * A name for the topic.\n   *\n   * If you don't specify a name, AWS CloudFormation generates a unique\n   * physical ID and uses that ID for the topic name. For more information,\n   * see Name Type.\n   *\n   * @default Generated name\n   */\n  readonly topicName?: string;\n\n  /**\n   * A KMS Key, either managed by this CDK app, or imported.\n   *\n   * @default None\n   */\n  readonly masterKey?: IKey;\n\n  /**\n   * Enables content-based deduplication for FIFO topics.\n   *\n   * @default None\n   */\n  readonly contentBasedDeduplication?: boolean;\n\n  /**\n   * Set to true to create a FIFO topic.\n   *\n   * @default None\n   */\n  readonly fifo?: boolean;\n}\n\n/**\n * A new SNS topic\n */\nexport class Topic extends TopicBase {\n\n  /**\n   * Import an existing SNS topic provided an ARN\n   *\n   * @param scope The parent creating construct\n   * @param id The construct's name\n   * @param topicArn topic ARN (i.e. arn:aws:sns:us-east-2:444455556666:MyTopic)\n   */\n  public static fromTopicArn(scope: Construct, id: string, topicArn: string): ITopic {\n    class Import extends TopicBase {\n      public readonly topicArn = topicArn;\n      public readonly topicName = Stack.of(scope).splitArn(topicArn, ArnFormat.NO_RESOURCE_NAME).resource;\n      public readonly fifo = this.topicName.endsWith('.fifo');\n      protected autoCreatePolicy: boolean = false;\n    }\n\n    return new Import(scope, id);\n  }\n\n  public readonly topicArn: string;\n  public readonly topicName: string;\n  public readonly fifo: boolean;\n\n  protected readonly autoCreatePolicy: boolean = true;\n\n  constructor(scope: Construct, id: string, props: TopicProps = {}) {\n    super(scope, id, {\n      physicalName: props.topicName,\n    });\n\n    if (props.fifo && !props.topicName) {\n      // NOTE: Workaround for CloudFormation problem reported in CDK issue 12386\n      // see https://github.com/aws/aws-cdk/issues/12386\n      throw new Error('FIFO SNS topics must be given a topic name.');\n    }\n\n    if (props.contentBasedDeduplication && !props.fifo) {\n      throw new Error('Content based deduplication can only be enabled for FIFO SNS topics.');\n    }\n\n    let cfnTopicName: string;\n    if (props.fifo && props.topicName && !props.topicName.endsWith('.fifo')) {\n      cfnTopicName = this.physicalName + '.fifo';\n    } else {\n      cfnTopicName = this.physicalName;\n    }\n\n    const resource = new CfnTopic(this, 'Resource', {\n      displayName: props.displayName,\n      topicName: cfnTopicName,\n      kmsMasterKeyId: props.masterKey && props.masterKey.keyArn,\n      contentBasedDeduplication: props.contentBasedDeduplication,\n      fifoTopic: props.fifo,\n    });\n\n    this.topicArn = this.getResourceArnAttribute(resource.ref, {\n      service: 'sns',\n      resource: this.physicalName,\n    });\n    this.topicName = this.getResourceNameAttribute(resource.attrTopicName);\n    this.fifo = props.fifo || false;\n  }\n}\n"],
  "mappings": "4MACA,OAAA,QAAA,YAAA,EAEA,gBAAA,QAAA,iBAAA,EACA,aAAA,QAAA,cAAA,EAiDA,MAAa,aAAc,cAAA,SAAS,CA0BlC,YAAY,MAAkB,GAAY,MAAoB,CAAA,EAAE,CAC9D,MAAM,MAAO,GAAI,CACf,aAAc,MAAM,UACrB,EAED,GAPiB,KAAA,iBAA4B,iEAOzC,MAAM,MAAQ,CAAC,MAAM,UAGvB,KAAM,IAAI,OAAM,6CAA6C,EAG/D,GAAI,MAAM,2BAA6B,CAAC,MAAM,KAC5C,KAAM,IAAI,OAAM,sEAAsE,EAGxF,GAAI,cACJ,AAAI,MAAM,MAAQ,MAAM,WAAa,CAAC,MAAM,UAAU,SAAS,OAAO,EACpE,aAAe,KAAK,aAAe,QAEnC,aAAe,KAAK,aAGtB,KAAM,UAAW,GAAI,iBAAA,SAAS,KAAM,WAAY,CAC9C,YAAa,MAAM,YACnB,UAAW,aACX,eAAgB,MAAM,WAAa,MAAM,UAAU,OACnD,0BAA2B,MAAM,0BACjC,UAAW,MAAM,KAClB,EAED,KAAK,SAAW,KAAK,wBAAwB,SAAS,IAAK,CACzD,QAAS,MACT,SAAU,KAAK,aAChB,EACD,KAAK,UAAY,KAAK,yBAAyB,SAAS,aAAa,EACrE,KAAK,KAAO,MAAM,MAAQ,SApDd,cAAa,MAAkB,GAAY,SAAgB,CACvE,MAAM,cAAe,cAAA,SAAS,CAA9B,aAAA,qBACkB,KAAA,SAAW,SACX,KAAA,UAAY,OAAA,MAAM,GAAG,KAAK,EAAE,SAAS,SAAU,OAAA,UAAU,gBAAgB,EAAE,SAC3E,KAAA,KAAO,KAAK,UAAU,SAAS,OAAO,EAC5C,KAAA,iBAA4B,EACxC,EAEA,MAAO,IAAI,QAAO,MAAO,EAAE,GAjB/B,QAAA,MAAA",
  "names": []
}
