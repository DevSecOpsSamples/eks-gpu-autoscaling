"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.countResources=exports.hasResourceProperties=exports.hasResource=exports.findResources=void 0;const __1=require(".."),absent_1=require("./matchers/absent"),section_1=require("./section");function findResources(template,type,props={}){var _a;const section=(_a=template.Resources)!==null&&_a!==void 0?_a:{},result=section_1.matchSection(filterType(section,type),props);return result.match?result.matches:{}}exports.findResources=findResources;function hasResource(template,type,props){var _a;const section=(_a=template.Resources)!==null&&_a!==void 0?_a:{},result=section_1.matchSection(filterType(section,type),props);if(!result.match)return result.closestResult===void 0?`No resource with type ${type} found`:[`Template has ${result.analyzedCount} resources with type ${type}, but none match as expected.`,section_1.formatFailure(result.closestResult)].join(`
`)}exports.hasResource=hasResource;function hasResourceProperties(template,type,props){let amended=JSON.parse(JSON.stringify(template));return(!__1.Matcher.isMatcher(props)||!(props instanceof absent_1.AbsentMatch))&&(amended=addEmptyProperties(amended)),hasResource(amended,type,__1.Match.objectLike({Properties:props}))}exports.hasResourceProperties=hasResourceProperties;function countResources(template,type){var _a;const section=(_a=template.Resources)!==null&&_a!==void 0?_a:{},types=filterType(section,type);return Object.entries(types).length}exports.countResources=countResources;function addEmptyProperties(template){var _a;let section=(_a=template.Resources)!==null&&_a!==void 0?_a:{};return Object.keys(section).map(key=>{section[key].hasOwnProperty("Properties")||(section[key].Properties={})}),template}function filterType(section,type){return Object.entries(section!=null?section:{}).filter(([_,v])=>v.Type===type).reduce((agg,[k,v])=>({...agg,[k]:v}),{})}
//# sourceMappingURL=resources.js.map
