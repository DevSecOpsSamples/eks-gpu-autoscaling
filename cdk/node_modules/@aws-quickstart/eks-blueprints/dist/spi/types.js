"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ClusterInfo = exports.GlobalResources = exports.ResourceContext = void 0;
const assert = require("assert");
/**
 * Provides API to register resource providers and get access to the provided resources.
 */
class ResourceContext {
    constructor(scope, blueprintProps) {
        this.scope = scope;
        this.blueprintProps = blueprintProps;
        this.resources = new Map();
    }
    /**
     * Adds a new resource provider and specifies the name under which the provided resource will be registered,
     * @param name Specifies the name key under which the provided resources will be registered for subsequent look-ups.
     * @param provider Implementation of the resource provider interface
     * @returns the provided resource
     */
    add(name, provider) {
        const resource = provider.provide(this);
        assert(!this.resources.has(name), `Overwriting ${name} resource during execution is not allowed.`);
        this.resources.set(name, resource);
        return resource;
    }
    /**
     * Gets the provided resource by the supplied name.
     * @param name under which the resource provider was registered
     * @returns the resource or undefined if the specified resource was not found
     */
    get(name) {
        return this.resources.get(name);
    }
}
exports.ResourceContext = ResourceContext;
var GlobalResources;
(function (GlobalResources) {
    GlobalResources["Vpc"] = "vpc";
    GlobalResources["HostedZone"] = "hosted-zone";
    GlobalResources["Certificate"] = "certificate";
})(GlobalResources = exports.GlobalResources || (exports.GlobalResources = {}));
/**
 * Cluster info supplies required information on the cluster configuration, registered resources and add-ons
 * which could be leveraged by the framework, add-on implementations and teams.
 */
class ClusterInfo {
    /**
     * Constructor for ClusterInfo
     * @param props
     */
    constructor(cluster, version, nodeGroups, autoscalingGroups) {
        this.cluster = cluster;
        this.version = version;
        this.nodeGroups = nodeGroups;
        this.autoscalingGroups = autoscalingGroups;
        this.cluster = cluster;
        this.provisionedAddOns = new Map();
        this.scheduledAddOns = new Map();
    }
    /**
     * Provides the resource context object associated with this instance of the EKS Blueprint.
     * @returns resource context object
     */
    getResourceContext() {
        return this.resourceContext;
    }
    /**
     * Injection method to provide resource context.
     * @param resourceContext
     */
    setResourceContext(resourceContext) {
        this.resourceContext = resourceContext;
    }
    /**
     * Update provisionedAddOns map
     * @param addOn
     * @param construct
     */
    addProvisionedAddOn(addOn, construct) {
        this.provisionedAddOns.set(addOn, construct);
    }
    /**
     * Given the addOn name, return the provisioned addOn construct
     * @param addOn
     * @returns undefined
     */
    getProvisionedAddOn(addOn) {
        return this.provisionedAddOns.get(addOn);
    }
    /**
    * Returns all provisioned addons
    * @returns scheduledAddOns: Map<string, cdk.Construct>
    */
    getAllProvisionedAddons() {
        return this.provisionedAddOns;
    }
    /**
     * Set the preProvisionedAddOn map with the promise for the construct
     * of the addon being provisioned
     * @param addOn
     * @param promise
     */
    addScheduledAddOn(addOn, promise) {
        this.scheduledAddOns.set(addOn, promise);
    }
    /**
     * Returns the promise for the Addon construct
     * @param addOn
     * @returns Promise<cdk.Construct>
     */
    getScheduledAddOn(addOn) {
        return this.scheduledAddOns.get(addOn);
    }
    /**
     * Returns all scheduled addons
     * @returns scheduledAddOns: Map<string, Promise<cdk.Construct>>
     */
    getAllScheduledAddons() {
        return this.scheduledAddOns;
    }
    /**
     * Provides the resource registered under supplied name
     * @param name of the resource to be returned
     * @returns Resource object or undefined if no resource was found
     */
    getResource(name) {
        return this.resourceContext.get(name);
    }
    /**
     * Same as {@link getResource} but will fail if the specified resource is not found
     * @param name of the resource to be returned
     * @returns Resource object (fails if not found)
     */
    getRequiredResource(name) {
        const result = this.resourceContext.get(name);
        assert(result, `Required resource ${name} is missing.`);
        return result;
    }
}
exports.ClusterInfo = ClusterInfo;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHlwZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9saWIvc3BpL3R5cGVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUlBLGlDQUFpQztBQXVFakM7O0dBRUc7QUFDSCxNQUFhLGVBQWU7SUFJeEIsWUFBNEIsS0FBZ0IsRUFBa0IsY0FBaUM7UUFBbkUsVUFBSyxHQUFMLEtBQUssQ0FBVztRQUFrQixtQkFBYyxHQUFkLGNBQWMsQ0FBbUI7UUFGOUUsY0FBUyxHQUErQixJQUFJLEdBQUcsRUFBRSxDQUFDO0lBRStCLENBQUM7SUFFbkc7Ozs7O09BS0c7SUFDSSxHQUFHLENBQTBDLElBQVksRUFBRSxRQUE2QjtRQUMzRixNQUFNLFFBQVEsR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3hDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLGVBQWUsSUFBSSw0Q0FBNEMsQ0FBQyxDQUFDO1FBQ25HLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxRQUFRLENBQUMsQ0FBQztRQUNuQyxPQUFPLFFBQVEsQ0FBQztJQUNwQixDQUFDO0lBRUQ7Ozs7T0FJRztJQUNJLEdBQUcsQ0FBMEMsSUFBWTtRQUM1RCxPQUFVLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3ZDLENBQUM7Q0FDSjtBQTNCRCwwQ0EyQkM7QUFFRCxJQUFZLGVBSVg7QUFKRCxXQUFZLGVBQWU7SUFDdkIsOEJBQVcsQ0FBQTtJQUNYLDZDQUEwQixDQUFBO0lBQzFCLDhDQUEyQixDQUFBO0FBQy9CLENBQUMsRUFKVyxlQUFlLEdBQWYsdUJBQWUsS0FBZix1QkFBZSxRQUkxQjtBQUdEOzs7R0FHRztBQUNILE1BQWEsV0FBVztJQU1wQjs7O09BR0c7SUFDSCxZQUFxQixPQUFnQixFQUFXLE9BQTBCLEVBQ3pELFVBQXdCLEVBQVcsaUJBQXNDO1FBRHJFLFlBQU8sR0FBUCxPQUFPLENBQVM7UUFBVyxZQUFPLEdBQVAsT0FBTyxDQUFtQjtRQUN6RCxlQUFVLEdBQVYsVUFBVSxDQUFjO1FBQVcsc0JBQWlCLEdBQWpCLGlCQUFpQixDQUFxQjtRQUN0RixJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztRQUN2QixJQUFJLENBQUMsaUJBQWlCLEdBQUcsSUFBSSxHQUFHLEVBQXFCLENBQUM7UUFDdEQsSUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLEdBQUcsRUFBOEIsQ0FBQztJQUNqRSxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksa0JBQWtCO1FBQ3JCLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQztJQUNoQyxDQUFDO0lBRUQ7OztPQUdHO0lBQ0ksa0JBQWtCLENBQUMsZUFBZ0M7UUFDdEQsSUFBSSxDQUFDLGVBQWUsR0FBRyxlQUFlLENBQUM7SUFDM0MsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxtQkFBbUIsQ0FBQyxLQUFhLEVBQUUsU0FBb0I7UUFDMUQsSUFBSSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsU0FBUyxDQUFDLENBQUM7SUFDakQsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxtQkFBbUIsQ0FBQyxLQUFhO1FBQ3BDLE9BQU8sSUFBSSxDQUFDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUM3QyxDQUFDO0lBRUE7OztNQUdFO0lBQ00sdUJBQXVCO1FBQzVCLE9BQU8sSUFBSSxDQUFDLGlCQUFpQixDQUFDO0lBQ2xDLENBQUM7SUFFRDs7Ozs7T0FLRztJQUNLLGlCQUFpQixDQUFDLEtBQWEsRUFBRSxPQUEyQjtRQUNoRSxJQUFJLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLENBQUM7SUFDN0MsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxpQkFBaUIsQ0FBQyxLQUFhO1FBQ2xDLE9BQU8sSUFBSSxDQUFDLGVBQWUsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDM0MsQ0FBQztJQUVEOzs7T0FHRztJQUNJLHFCQUFxQjtRQUN4QixPQUFPLElBQUksQ0FBQyxlQUFlLENBQUM7SUFDaEMsQ0FBQztJQUVEOzs7O09BSUc7SUFDSSxXQUFXLENBQTBCLElBQVk7UUFDcEQsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDLEdBQUcsQ0FBSSxJQUFJLENBQUMsQ0FBQztJQUM3QyxDQUFDO0lBRUQ7Ozs7T0FJRztJQUNJLG1CQUFtQixDQUEwQixJQUFZO1FBQzVELE1BQU0sTUFBTSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUMsR0FBRyxDQUFJLElBQUksQ0FBQyxDQUFDO1FBQ2pELE1BQU0sQ0FBQyxNQUFNLEVBQUUscUJBQXFCLElBQUksY0FBYyxDQUFDLENBQUM7UUFDeEQsT0FBTyxNQUFPLENBQUM7SUFDbkIsQ0FBQztDQUNKO0FBekdELGtDQXlHQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEF1dG9TY2FsaW5nR3JvdXAgfSBmcm9tICdhd3MtY2RrLWxpYi9hd3MtYXV0b3NjYWxpbmcnO1xuaW1wb3J0IHsgQ2x1c3RlciwgS3ViZXJuZXRlc1ZlcnNpb24sIE5vZGVncm91cCB9IGZyb20gJ2F3cy1jZGstbGliL2F3cy1la3MnO1xuaW1wb3J0ICogYXMgY2RrIGZyb20gJ2F3cy1jZGstbGliJztcbmltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gJ2NvbnN0cnVjdHMnO1xuaW1wb3J0ICogYXMgYXNzZXJ0IGZyb20gXCJhc3NlcnRcIjtcbmltcG9ydCB7IFJlc291cmNlUHJvdmlkZXIgfSBmcm9tICcuJztcbmltcG9ydCB7IEVrc0JsdWVwcmludFByb3BzIH0gZnJvbSAnLi4vc3RhY2tzJztcblxuLyoqXG4gKiBEYXRhIHR5cGUgZGVmaW5pbmcgaGVsbSByZXBvc2l0b3JpZXMgZm9yIEdpdE9wcyBib290c3RyYXBwaW5nLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIEhlbG1SZXBvc2l0b3J5IHtcbiAgICByZXBvVXJsOiBzdHJpbmcsXG4gICAgbmFtZTogc3RyaW5nLFxuICAgIHVzZXJuYW1lPzogc3RyaW5nLFxuICAgIHBhc3N3b3JkPzogc3RyaW5nXG59XG5cbi8qKlxuICogVXRpbGl0eSB0eXBlIGZvciB2YWx1ZXMgcGFzc2VkIHRvIEhlbG0gb3IgR2l0T3BzIGFwcGxpY2F0aW9ucy5cbiAqL1xuIGV4cG9ydCB0eXBlIFZhbHVlcyA9IHtcbiAgICBba2V5OiBzdHJpbmddOiBhbnk7XG59O1xuXG4vKipcbiAqIEludGVyZmFjZSB0aGF0IGluY2x1ZGVzIGEgcmVmZXJlbmNlIHRvIGEgR2l0IHJlcG9zaXRvcnkgZm9yIHJldXNlLCB3aXRob3V0IGNyZWRlbnRpYWxzIFxuICogYW5kIG90aGVyIGFjY2VzcyBpbmZvcm1hdGlvbi5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBHaXRSZXBvc2l0b3J5UmVmZXJlbmNlIHtcbiAgICAvKipcbiAgICAgKiBFeHBlY3RlZCB0byBzdXBwb3J0IGhlbG0gc3R5bGUgcmVwbyBhdCB0aGUgbW9tZW50XG4gICAgICovXG4gICAgcmVwb1VybDogc3RyaW5nLFxuXG4gICAgLyoqIFxuICAgICAqIFBhdGggd2l0aGluIHRoZSByZXBvc2l0b3J5IFxuICAgICAqL1xuICAgIHBhdGg/OiBzdHJpbmcsXG5cbiAgICAvKipcbiAgICAgKiBPcHRpb25hbCBuYW1lIGZvciB0aGUgYm9vdHN0cmFwIGFwcGxpY2F0aW9uXG4gICAgICovXG4gICAgbmFtZT86IHN0cmluZyxcblxuICAgIC8qKlxuICAgICAqIE9wdGlvbmFsIHRhcmdldCByZXZpc2lvbiBmb3IgdGhlIHJlcG9zaXRvcnkuXG4gICAgICogVGFyZ2V0UmV2aXNpb24gZGVmaW5lcyB0aGUgcmV2aXNpb24gb2YgdGhlIHNvdXJjZVxuICAgICAqIHRvIHN5bmMgdGhlIGFwcGxpY2F0aW9uIHRvLiBJbiBjYXNlIG9mIEdpdCwgdGhpcyBjYW4gYmVcbiAgICAgKiBjb21taXQsIHRhZywgb3IgYnJhbmNoLiBJZiBvbWl0dGVkLCB3aWxsIGVxdWFsIHRvIEhFQUQuXG4gICAgICogSW4gY2FzZSBvZiBIZWxtLCB0aGlzIGlzIGEgc2VtdmVyIHRhZyBmb3IgdGhlIENoYXJ0J3MgdmVyc2lvbi5cbiAgICAgKi9cbiAgICB0YXJnZXRSZXZpc2lvbj86IHN0cmluZ1xufVxuXG4vKipcbiAqIERhdGEgdHlwZSBkZWZpbmluZyBhbiBhcHBsaWNhdGlvbiByZXBvc2l0b3J5IChnaXQpLiBcbiAqL1xuZXhwb3J0IGludGVyZmFjZSBBcHBsaWNhdGlvblJlcG9zaXRvcnkgZXh0ZW5kcyBHaXRSZXBvc2l0b3J5UmVmZXJlbmNlIHtcblxuICAgIC8qKlxuICAgICAqIFNlY3JldCBmcm9tIEFXUyBTZWNyZXRzIE1hbmFnZXIgdG8gaW1wb3J0IGNyZWRlbnRpYWxzIHRvIGFjY2VzcyB0aGUgc3BlY2lmaWVkIGdpdCByZXBvc2l0b3J5LlxuICAgICAqIFRoZSBzZWNyZXQgbXVzdCBleGlzdCBpbiB0aGUgc2FtZSByZWdpb24gYW5kIGFjY291bnQgd2hlcmUgdGhlIHN0YWNrIHdpbGwgcnVuLiBcbiAgICAgKi9cbiAgICBjcmVkZW50aWFsc1NlY3JldE5hbWU/OiBzdHJpbmcsXG5cbiAgICAvKipcbiAgICAgKiBEZXBlbmRpbmcgb24gY3JlZGVudGlhbHMgdHlwZSB0aGUgYXJuIHNob3VsZCBlaXRoZXIgcG9pbnQgdG8gYW4gU1NIIGtleSAocGxhaW4gdGV4dCB2YWx1ZSlcbiAgICAgKiBvciBhIGpzb24gZmlsZSB3aXRoIHVzZXJuYW1lL3Bhc3N3b3JkIGF0dHJpYnV0ZXMuXG4gICAgICogRm9yIFRPS0VOIHR5cGUgdXNlcm5hbWUgY2FuIGJlIGFueSBub24tZW1wdHkgdXNlcm5hbWUgYW5kIHRva2VuIHZhbHVlIGFzIHBhc3N3b3JkLlxuICAgICAqL1xuICAgIGNyZWRlbnRpYWxzVHlwZT86IFwiVVNFUk5BTUVcIiB8IFwiVE9LRU5cIiB8IFwiU1NIXCJcblxufVxuXG4vKipcbiAqIFByb3ZpZGVzIEFQSSB0byByZWdpc3RlciByZXNvdXJjZSBwcm92aWRlcnMgYW5kIGdldCBhY2Nlc3MgdG8gdGhlIHByb3ZpZGVkIHJlc291cmNlcy5cbiAqL1xuZXhwb3J0IGNsYXNzIFJlc291cmNlQ29udGV4dCB7XG5cbiAgICBwcml2YXRlIHJlYWRvbmx5IHJlc291cmNlczogTWFwPHN0cmluZywgY2RrLklSZXNvdXJjZT4gPSBuZXcgTWFwKCk7XG5cbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgcmVhZG9ubHkgc2NvcGU6IGNkay5TdGFjaywgcHVibGljIHJlYWRvbmx5IGJsdWVwcmludFByb3BzOiBFa3NCbHVlcHJpbnRQcm9wcykge31cbiAgICBcbiAgICAvKipcbiAgICAgKiBBZGRzIGEgbmV3IHJlc291cmNlIHByb3ZpZGVyIGFuZCBzcGVjaWZpZXMgdGhlIG5hbWUgdW5kZXIgd2hpY2ggdGhlIHByb3ZpZGVkIHJlc291cmNlIHdpbGwgYmUgcmVnaXN0ZXJlZCxcbiAgICAgKiBAcGFyYW0gbmFtZSBTcGVjaWZpZXMgdGhlIG5hbWUga2V5IHVuZGVyIHdoaWNoIHRoZSBwcm92aWRlZCByZXNvdXJjZXMgd2lsbCBiZSByZWdpc3RlcmVkIGZvciBzdWJzZXF1ZW50IGxvb2stdXBzLlxuICAgICAqIEBwYXJhbSBwcm92aWRlciBJbXBsZW1lbnRhdGlvbiBvZiB0aGUgcmVzb3VyY2UgcHJvdmlkZXIgaW50ZXJmYWNlXG4gICAgICogQHJldHVybnMgdGhlIHByb3ZpZGVkIHJlc291cmNlXG4gICAgICovXG4gICAgcHVibGljIGFkZDxUIGV4dGVuZHMgY2RrLklSZXNvdXJjZSA9IGNkay5JUmVzb3VyY2U+KG5hbWU6IHN0cmluZywgcHJvdmlkZXI6IFJlc291cmNlUHJvdmlkZXI8VD4pIDogVCB7XG4gICAgICAgIGNvbnN0IHJlc291cmNlID0gcHJvdmlkZXIucHJvdmlkZSh0aGlzKTtcbiAgICAgICAgYXNzZXJ0KCF0aGlzLnJlc291cmNlcy5oYXMobmFtZSksIGBPdmVyd3JpdGluZyAke25hbWV9IHJlc291cmNlIGR1cmluZyBleGVjdXRpb24gaXMgbm90IGFsbG93ZWQuYCk7XG4gICAgICAgIHRoaXMucmVzb3VyY2VzLnNldChuYW1lLCByZXNvdXJjZSk7XG4gICAgICAgIHJldHVybiByZXNvdXJjZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBwcm92aWRlZCByZXNvdXJjZSBieSB0aGUgc3VwcGxpZWQgbmFtZS4gXG4gICAgICogQHBhcmFtIG5hbWUgdW5kZXIgd2hpY2ggdGhlIHJlc291cmNlIHByb3ZpZGVyIHdhcyByZWdpc3RlcmVkXG4gICAgICogQHJldHVybnMgdGhlIHJlc291cmNlIG9yIHVuZGVmaW5lZCBpZiB0aGUgc3BlY2lmaWVkIHJlc291cmNlIHdhcyBub3QgZm91bmRcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0PFQgZXh0ZW5kcyBjZGsuSVJlc291cmNlID0gY2RrLklSZXNvdXJjZT4obmFtZTogc3RyaW5nKSA6IFQgfCB1bmRlZmluZWQge1xuICAgICAgICByZXR1cm4gPFQ+dGhpcy5yZXNvdXJjZXMuZ2V0KG5hbWUpO1xuICAgIH1cbn1cblxuZXhwb3J0IGVudW0gR2xvYmFsUmVzb3VyY2VzIHtcbiAgICBWcGMgPSAndnBjJyxcbiAgICBIb3N0ZWRab25lID0gJ2hvc3RlZC16b25lJyxcbiAgICBDZXJ0aWZpY2F0ZSA9ICdjZXJ0aWZpY2F0ZSdcbn1cblxuXG4vKipcbiAqIENsdXN0ZXIgaW5mbyBzdXBwbGllcyByZXF1aXJlZCBpbmZvcm1hdGlvbiBvbiB0aGUgY2x1c3RlciBjb25maWd1cmF0aW9uLCByZWdpc3RlcmVkIHJlc291cmNlcyBhbmQgYWRkLW9ucyBcbiAqIHdoaWNoIGNvdWxkIGJlIGxldmVyYWdlZCBieSB0aGUgZnJhbWV3b3JrLCBhZGQtb24gaW1wbGVtZW50YXRpb25zIGFuZCB0ZWFtcy5cbiAqL1xuZXhwb3J0IGNsYXNzIENsdXN0ZXJJbmZvIHtcbiAgICBcbiAgICBwcml2YXRlIHJlYWRvbmx5IHByb3Zpc2lvbmVkQWRkT25zOiBNYXA8c3RyaW5nLCBDb25zdHJ1Y3Q+O1xuICAgIHByaXZhdGUgcmVhZG9ubHkgc2NoZWR1bGVkQWRkT25zOiBNYXA8c3RyaW5nLCBQcm9taXNlPENvbnN0cnVjdD4+O1xuICAgIHByaXZhdGUgcmVzb3VyY2VDb250ZXh0OiBSZXNvdXJjZUNvbnRleHQ7XG5cbiAgICAvKipcbiAgICAgKiBDb25zdHJ1Y3RvciBmb3IgQ2x1c3RlckluZm9cbiAgICAgKiBAcGFyYW0gcHJvcHMgXG4gICAgICovXG4gICAgY29uc3RydWN0b3IocmVhZG9ubHkgY2x1c3RlcjogQ2x1c3RlciwgcmVhZG9ubHkgdmVyc2lvbjogS3ViZXJuZXRlc1ZlcnNpb24sIFxuICAgICAgICAgICAgcmVhZG9ubHkgbm9kZUdyb3Vwcz86IE5vZGVncm91cFtdLCByZWFkb25seSBhdXRvc2NhbGluZ0dyb3Vwcz86IEF1dG9TY2FsaW5nR3JvdXBbXSkgeyBcbiAgICAgICAgdGhpcy5jbHVzdGVyID0gY2x1c3RlcjtcbiAgICAgICAgdGhpcy5wcm92aXNpb25lZEFkZE9ucyA9IG5ldyBNYXA8c3RyaW5nLCBDb25zdHJ1Y3Q+KCk7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVkQWRkT25zID0gbmV3IE1hcDxzdHJpbmcsIFByb21pc2U8Q29uc3RydWN0Pj4oKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcm92aWRlcyB0aGUgcmVzb3VyY2UgY29udGV4dCBvYmplY3QgYXNzb2NpYXRlZCB3aXRoIHRoaXMgaW5zdGFuY2Ugb2YgdGhlIEVLUyBCbHVlcHJpbnQuXG4gICAgICogQHJldHVybnMgcmVzb3VyY2UgY29udGV4dCBvYmplY3RcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0UmVzb3VyY2VDb250ZXh0KCk6IFJlc291cmNlQ29udGV4dCB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlc291cmNlQ29udGV4dDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbmplY3Rpb24gbWV0aG9kIHRvIHByb3ZpZGUgcmVzb3VyY2UgY29udGV4dC5cbiAgICAgKiBAcGFyYW0gcmVzb3VyY2VDb250ZXh0IFxuICAgICAqL1xuICAgIHB1YmxpYyBzZXRSZXNvdXJjZUNvbnRleHQocmVzb3VyY2VDb250ZXh0OiBSZXNvdXJjZUNvbnRleHQpIHtcbiAgICAgICAgdGhpcy5yZXNvdXJjZUNvbnRleHQgPSByZXNvdXJjZUNvbnRleHQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHByb3Zpc2lvbmVkQWRkT25zIG1hcFxuICAgICAqIEBwYXJhbSBhZGRPbiBcbiAgICAgKiBAcGFyYW0gY29uc3RydWN0IFxuICAgICAqL1xuICAgIHB1YmxpYyBhZGRQcm92aXNpb25lZEFkZE9uKGFkZE9uOiBzdHJpbmcsIGNvbnN0cnVjdDogQ29uc3RydWN0KSB7XG4gICAgICAgIHRoaXMucHJvdmlzaW9uZWRBZGRPbnMuc2V0KGFkZE9uLCBjb25zdHJ1Y3QpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdpdmVuIHRoZSBhZGRPbiBuYW1lLCByZXR1cm4gdGhlIHByb3Zpc2lvbmVkIGFkZE9uIGNvbnN0cnVjdFxuICAgICAqIEBwYXJhbSBhZGRPbiBcbiAgICAgKiBAcmV0dXJucyB1bmRlZmluZWRcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0UHJvdmlzaW9uZWRBZGRPbihhZGRPbjogc3RyaW5nKTogQ29uc3RydWN0IHwgdW5kZWZpbmVkIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvdmlzaW9uZWRBZGRPbnMuZ2V0KGFkZE9uKTtcbiAgICB9XG5cbiAgICAgLyoqXG4gICAgICogUmV0dXJucyBhbGwgcHJvdmlzaW9uZWQgYWRkb25zXG4gICAgICogQHJldHVybnMgc2NoZWR1bGVkQWRkT25zOiBNYXA8c3RyaW5nLCBjZGsuQ29uc3RydWN0PlxuICAgICAqL1xuICAgICAgcHVibGljIGdldEFsbFByb3Zpc2lvbmVkQWRkb25zKCk6IE1hcDxzdHJpbmcsIENvbnN0cnVjdD4ge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm92aXNpb25lZEFkZE9ucztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIHByZVByb3Zpc2lvbmVkQWRkT24gbWFwIHdpdGggdGhlIHByb21pc2UgZm9yIHRoZSBjb25zdHJ1Y3RcbiAgICAgKiBvZiB0aGUgYWRkb24gYmVpbmcgcHJvdmlzaW9uZWRcbiAgICAgKiBAcGFyYW0gYWRkT25cbiAgICAgKiBAcGFyYW0gcHJvbWlzZVxuICAgICAqL1xuICAgICBwdWJsaWMgYWRkU2NoZWR1bGVkQWRkT24oYWRkT246IHN0cmluZywgcHJvbWlzZTogUHJvbWlzZTxDb25zdHJ1Y3Q+KSB7XG4gICAgICAgIHRoaXMuc2NoZWR1bGVkQWRkT25zLnNldChhZGRPbiwgcHJvbWlzZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcHJvbWlzZSBmb3IgdGhlIEFkZG9uIGNvbnN0cnVjdFxuICAgICAqIEBwYXJhbSBhZGRPblxuICAgICAqIEByZXR1cm5zIFByb21pc2U8Y2RrLkNvbnN0cnVjdD5cbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0U2NoZWR1bGVkQWRkT24oYWRkT246IHN0cmluZyk6IFByb21pc2U8Q29uc3RydWN0PiB8IHVuZGVmaW5lZCB7XG4gICAgICAgIHJldHVybiB0aGlzLnNjaGVkdWxlZEFkZE9ucy5nZXQoYWRkT24pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYWxsIHNjaGVkdWxlZCBhZGRvbnNcbiAgICAgKiBAcmV0dXJucyBzY2hlZHVsZWRBZGRPbnM6IE1hcDxzdHJpbmcsIFByb21pc2U8Y2RrLkNvbnN0cnVjdD4+XG4gICAgICovXG4gICAgcHVibGljIGdldEFsbFNjaGVkdWxlZEFkZG9ucygpOiBNYXA8c3RyaW5nLCBQcm9taXNlPENvbnN0cnVjdD4+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2NoZWR1bGVkQWRkT25zO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFByb3ZpZGVzIHRoZSByZXNvdXJjZSByZWdpc3RlcmVkIHVuZGVyIHN1cHBsaWVkIG5hbWVcbiAgICAgKiBAcGFyYW0gbmFtZSBvZiB0aGUgcmVzb3VyY2UgdG8gYmUgcmV0dXJuZWRcbiAgICAgKiBAcmV0dXJucyBSZXNvdXJjZSBvYmplY3Qgb3IgdW5kZWZpbmVkIGlmIG5vIHJlc291cmNlIHdhcyBmb3VuZFxuICAgICAqL1xuICAgIHB1YmxpYyBnZXRSZXNvdXJjZTxUIGV4dGVuZHMgY2RrLklSZXNvdXJjZT4obmFtZTogc3RyaW5nKTogVCB8IHVuZGVmaW5lZCB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlc291cmNlQ29udGV4dC5nZXQ8VD4obmFtZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2FtZSBhcyB7QGxpbmsgZ2V0UmVzb3VyY2V9IGJ1dCB3aWxsIGZhaWwgaWYgdGhlIHNwZWNpZmllZCByZXNvdXJjZSBpcyBub3QgZm91bmRcbiAgICAgKiBAcGFyYW0gbmFtZSBvZiB0aGUgcmVzb3VyY2UgdG8gYmUgcmV0dXJuZWRcbiAgICAgKiBAcmV0dXJucyBSZXNvdXJjZSBvYmplY3QgKGZhaWxzIGlmIG5vdCBmb3VuZClcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0UmVxdWlyZWRSZXNvdXJjZTxUIGV4dGVuZHMgY2RrLklSZXNvdXJjZT4obmFtZTogc3RyaW5nKTogVCB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMucmVzb3VyY2VDb250ZXh0LmdldDxUPihuYW1lKTtcbiAgICAgICAgYXNzZXJ0KHJlc3VsdCwgYFJlcXVpcmVkIHJlc291cmNlICR7bmFtZX0gaXMgbWlzc2luZy5gKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdCE7XG4gICAgfVxufSJdfQ==